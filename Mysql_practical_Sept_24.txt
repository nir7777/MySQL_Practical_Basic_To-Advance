****************************************************************************************************************************************
                     *
 1. Show Database:   *
                     *
**********************

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sakila             |
| sys                |
| world              |
+--------------------+
6 rows in set (0.00 sec)



****************************************************************************************************************************************
                     *
 2. Create Database: *
                     *
**********************


mysql> create database test_db;
Query OK, 1 row affected (0.01 sec)

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sakila             |
| sys                |
| test_db            |
| world              |
+--------------------+
7 rows in set (0.00 sec)



****************************************************************************************************************************************
                     *
 3. Use Database:    *
                     *
**********************

mysql> USE test_db;
Database changed



****************************************************************************************************************************************
                        *
 4. select database();  *   To check current database is same as we selected by using use database cmd.
                        *
*************************

mysql> SELECT DATABASE();
+------------+
| DATABASE() |
+------------+
| test_db    |
+------------+
1 row in set (0.00 sec)




****************************************************************************************************************************************
                          *
 5. Deleting Database:    *
                          *
***************************

mysql> DROP DATABASE test_db;
Query OK, 0 rows affected (0.02 sec)

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sakila             |
| sys                |
| world              |
+--------------------+
6 rows in set (0.01 sec)




****************************************************************************************************************************************
                          *
 5. Creating Table:       *
                          *
***************************

mysql> CREATE DATABASE store_db;
Query OK, 1 row affected (0.02 sec)

mysql> USE store_db;
Database changed

mysql> CREATE TABLE customers(
    -> id INT,
    -> name varchar(100)
    -> );
Query OK, 0 rows affected (0.03 sec)





****************************************************************************************************************************************
                          *
 6. Describe Table:       *
                          *
***************************

mysql> DESC customers;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | int          | YES  |     | NULL    |       |
| name  | varchar(100) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
2 rows in set (0.00 sec)





****************************************************************************************************************************************
                          *
7. Show Tables:           *
                          *
***************************

mysql> show tables;
+--------------------+
| Tables_in_store_db |
+--------------------+
| customers          |
+--------------------+
1 row in set (0.00 sec)





****************************************************************************************************************************************
                             *
8. Insert Data in Tables:    *
                             *
******************************

mysql> INSERT INTO customers(id,name) VALUES(1,'Ajay');
Query OK, 1 row affected (0.01 sec)

mysql> INSERT INTO customers(id,name) VALUES(2,'Ritu');
Query OK, 1 row affected (0.01 sec)

*Insert multiple record at once
mysql> INSERT INTO customers(id,name) VALUES(3,'Akshay'), (4, 'Simran'), (5,'Pranav');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> DESC customers;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | int          | YES  |     | NULL    |       |
| name  | varchar(100) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
2 rows in set (0.00 sec)






****************************************************************************************************************************************
                             *
9. Reading data from Table   *
                             *
******************************


mysql> SELECT * FROM customers;
+------+--------+
| id   | name   |
+------+--------+
|    1 | Ajay   |
|    2 | Ritu   |
|    3 | Akshay |
|    4 | Simran |
|    5 | Pranav |
+------+--------+
5 rows in set (0.00 sec)

Reading columns:
mysql> SELECT id FROM customers;
+------+
| id   |
+------+
|    1 |
|    2 |
|    3 |
|    4 |
|    5 |
+------+
5 rows in set (0.00 sec)


mysql> SELECT id,name FROM customers;
+------+--------+
| id   | name   |
+------+--------+
|    1 | Ajay   |
|    2 | Ritu   |
|    3 | Akshay |
|    4 | Simran |
|    5 | Pranav |
+------+--------+
5 rows in set (0.00 sec)



****************************************************************************************************************************************
                             *
10. Where clause Condition   *
                             *
******************************

 mysql> SELECT * FROM customers WHERE id=4;
+------+--------+
| id   | name   |
+------+--------+
|    4 | Simran |
+------+--------+
1 row in set (0.00 sec)


mysql> SELECT * FROM customers WHERE name='RItu';
+------+------+
| id   | name |
+------+------+
|    2 | Ritu |
+------+------+
1 row in set (0.00 sec)




****************************************************************************************************************************************
                              *
11. Modify/Update Table Data  *
                              *
*******************************

mysql> UPDATE customers SET name='Abhishek' WHERE id=3;
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM customers;
+------+----------+
| id   | name     |
+------+----------+
|    1 | Ajay     |
|    2 | Ritu     |
|    3 | Abhishek |
|    4 | Simran   |
|    5 | Pranav   |
+------+----------+
5 rows in set (0.00 sec)




****************************************************************************************************************************************
                              *
12. Deleting Data from Table  *
                              *
*******************************

mysql> DELETE FROM customers WHERE id=5;
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM customers;
+------+----------+
| id   | name     |
+------+----------+
|    1 | Ajay     |
|    2 | Ritu     |
|    3 | Abhishek |
|    4 | Simran   |
+------+----------+
4 rows in set (0.00 sec)


****************************************************************************************************************************************
                              *
13. Deleting Whole Table      *
                              *
*******************************

mysql> Drop table customers;
Query OK, 0 rows affected (0.01 sec)

mysql> SELECT * FROM customers;
ERROR 1146 (42S02): Table 'store_db.customers' doesn't exist
mysql>



****************************************************************************************************************************************
                              *
14. NOT NULL                  *
                              *
*******************************

Lets check our tables description:

mysql> desc customers;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| id    | int          | YES  |     | NULL    |       |
| name  | varchar(100) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
2 rows in set (0.00 sec)

* As we can see Null column represents yes it means while inserting data 
  we can keep any column as null value.
* Now lets add only value of id:

mysql> INSERT INTO customers(id) VALUES(1);
Query OK, 1 row affected (0.01 sec)

mysql> select * from customers;
+------+------+
| id   | name |
+------+------+
|    1 | NULL |
+------+------+
1 row in set (0.00 sec)

* As we see value of name is NULL it means if we didn't gave value to any column it will 
  take null bydefault, as the default column showing NULL.
* If we do not provide value for any column sql takes it as null.

* mysql> INSERT INTO customers(name) VALUES('Jay');
Query OK, 1 row affected (0.00 sec)


* We can not keep both values as empty:
mysql> INSERT INTO customers VALUES;
* This will throw error.


mysql> select * from customers;
+------+------+
| id   | name |
+------+------+
|    1 | NULL |
| NULL | Jay  |
+------+------+
2 rows in set (0.00 sec)


We can avoid above case by using not null while declaring the column.

mysql> CREATE TABLE customers1(
    -> id INT NOT NULL,
    -> name VARCHAR(50) NOT NULL
    -> );
Query OK, 0 rows affected (0.03 sec)

mysql> DESC customers1;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| id    | int         | NO   |     | NULL    |       |
| name  | varchar(50) | NO   |     | NULL    |       |
+-------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)


* Now here Null column contains NO i.e we cannot keep that column null, 
  we need to insert a value init. 
mysql> INSERT INTO customers1(id) VALUES(1);
ERROR 1364 (HY000): Field 'name' doesn't have a default value




****************************************************************************************************************************************
                              *
15. Default Values            *
                              *
*******************************


mysql> DESC customer2;
+----------+-------------+------+-----+---------+-------+
| Field    | Type        | Null | Key | Default | Extra |
+----------+-------------+------+-----+---------+-------+
| id       | int         | YES  |     | NULL    |       |
| name     | varchar(50) | YES  |     | NULL    |       |
| acc_type | varchar(50) | YES  |     | NULL    |       |
+----------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)



mysql> CREATE TABLE customer3(
    -> id INT NOT NULL,
    -> name VARCHAR(50),
    -> acc_type VARCHAR(50) NOT NULL DEFAULT 'Savings');
Query OK, 0 rows affected (0.03 sec)

mysql> DESC customer3;
+----------+-------------+------+-----+---------+-------+
| Field    | Type        | Null | Key | Default | Extra |
+----------+-------------+------+-----+---------+-------+
| id       | int         | NO   |     | NULL    |       |
| name     | varchar(50) | YES  |     | NULL    |       |
| acc_type | varchar(50) | NO   |     | Savings |       |
+----------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)

* In above table we have set a default value for acc_type.

mysql> INSERT INTO customer3(id,name,acc_type) VALUES(1,'Lucky','savings') ;
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM customer3;
+----+-------+----------+
| id | name  | acc_type |
+----+-------+----------+
|  1 | Lucky | savings  |
+----+-------+----------+
1 row in set (0.00 sec)

* Above we have wrote savings in small case it means we can write any name there while inserting.

mysql> INSERT INTO customer3(id,name) VALUES(1,'Lucky') ;
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM customer3;
+----+-------+----------+
| id | name  | acc_type |
+----+-------+----------+
|  1 | Lucky | savings  |
|  1 | Lucky | Savings  |
+----+-------+----------+
2 rows in set (0.00 sec)

Above we have not mention acc_type column while inserting but it is taking Savings as default value.




************************************************************************************************************************************************************************
                              *
16. Primary Key               *
                              *
*******************************

mysql> CREATE TABLE customer4(
    -> acc_no INT PRIMARY KEY,
    -> name VARCHAR(50) NOT NULL,
    -> acc_type VARCHAR(50) NOT NULL DEFAULT 'Savings'
    -> );
Query OK, 0 rows affected (0.03 sec)

mysql> DESC customer4;
+----------+-------------+------+-----+---------+-------+
| Field    | Type        | Null | Key | Default | Extra |
+----------+-------------+------+-----+---------+-------+
| acc_no   | int         | NO   | PRI | NULL    |       |
| name     | varchar(50) | NO   |     | NULL    |       |
| acc_type | varchar(50) | NO   |     | Savings |       |
+----------+-------------+------+-----+---------+-------+
3 rows in set (0.00 sec)


* When we give primary key to a column there is no need to mention NOT NULL.

mysql> INSERT INTO customer4(acc_no,name)
    -> VALUES(1001, 'Raj'), (1002, 'Dev'), (1003, 'Mayank');
Query OK, 3 rows affected (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 0

mysql> SELECT  * FROM customer4;
+--------+--------+----------+
| acc_no | name   | acc_type |
+--------+--------+----------+
|   1001 | Raj    | Savings  |
|   1002 | Dev    | Savings  |
|   1003 | Mayank | Savings  |
+--------+--------+----------+
3 rows in set (0.00 sec)

* We cannot repeat the value of primary key column, it should be unique always.
* Duplicate values are not allowed in primary key column.
* One table can contain only 1 primary key column.
* Primary Key column cannot be empty/NULL while inserting record.



************************************************************************************************************************************************************************
                              *
16. Auto Increment            *
                              *
*******************************

mysql> CREATE TABLE customer5(
    -> id INT PRIMARY KEY AUTO_INCREMENT,
    -> name VARCHAR(50) NOT NULL,
    -> acc_type VARCHAR(50) NOT NULL
    -> );
Query OK, 0 rows affected (0.03 sec)

mysql> DESC customer5;
+----------+-------------+------+-----+---------+----------------+
| Field    | Type        | Null | Key | Default | Extra          |
+----------+-------------+------+-----+---------+----------------+
| id       | int         | NO   | PRI | NULL    | auto_increment |
| name     | varchar(50) | NO   |     | NULL    |                |
| acc_type | varchar(50) | NO   |     | NULL    |                |
+----------+-------------+------+-----+---------+----------------+
3 rows in set (0.00 sec)


mysql> INSERT INTO customer5(name,acc_type) VALUES("Raj","Savings");
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM customer5;
+----+------+----------+
| id | name | acc_type |
+----+------+----------+
|  1 | Raj  | Savings  |
+----+------+----------+
1 row in set (0.00 sec)

mysql> INSERT INTO customer5(name,acc_type) VALUES("Shyam","Savings"),('Gau','Savings');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0

mysql> INSERT INTO customer5(id,name,acc_type) VALUES(101,"Prem","Savings");
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM customer5;
+-----+-------+----------+
| id  | name  | acc_type |
+-----+-------+----------+
|   1 | Raj   | Savings  |
|   2 | Shyam | Savings  |
|   3 | Gau   | Savings  |
| 101 | Prem  | Savings  |
+-----+-------+----------+
4 rows in set (0.00 sec)





************************************************************************************************************************************************************************
                              *
17. Alias                     *
                              *
*******************************

mysql> SELECT acc_type AS 'Account Number' FROM customer5;
+----------------+
| Account Number |
+----------------+
| Savings        |
| Savings        |
| Savings        |
| Savings        |
+----------------+
4 rows in set (0.00 sec)





************************************************************************************************************************************************************************
*                             *
*    Exercise 01              *
*                             *
*******************************


Q. Create a database- bank_db
Q. Create a table-employees which contains,
   emp_id, name,designation,dept.
Q. emp_id column should not allow duplicate and null values
   Value of emp_id column should auto increment
Q. name column should not contain null value
Q. desig column should have default value as 'Probation'


mysql> CREATE DATABASE bank_db;
Query OK, 1 row affected (0.02 sec)

mysql> USE bank_db;
Database changed

mysql> CREATE TABLE employees(
    -> emp_id INT PRIMARY KEY AUTO_INCREMENT,
    -> name VARCHAR(50) NOT NULL,
    -> designation VARCHAR(50) NOT NULL DEFAULT 'Probation',
    -> dept VARCHAR(50) NOT NULL
    -> );
Query OK, 0 rows affected (0.03 sec)


mysql> DESC employees;
+-------------+-------------+------+-----+-----------+----------------+
| Field       | Type        | Null | Key | Default   | Extra          |
+-------------+-------------+------+-----+-----------+----------------+
| emp_id      | int         | NO   | PRI | NULL      | auto_increment |
| name        | varchar(50) | NO   |     | NULL      |                |
| designation | varchar(50) | NO   |     | Probation |                |
| dept        | varchar(50) | NO   |     | NULL      |                |
+-------------+-------------+------+-----+-----------+----------------+
4 rows in set (0.00 sec)

Q. Insert Data into table

mysql> INSERT INTO employees(emp_id,name,designation,dept)
    -> VALUES(101,'Raju','Manager','Loan'),
    -> (102,'Sham','Cashier','Cash');
Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0


mysql> INSERT INTO employees(name,designation,dept)
    -> VALUES('Paul','Associate','Loan'),
    -> ('Alex','Accountant','Account'),
    -> ('Victor','Associate','Deposit');
Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0


Q. Display Data of table:

mysql> SELECT * FROM employees;
+--------+--------+-------------+---------+
| emp_id | name   | designation | dept    |
+--------+--------+-------------+---------+
|    101 | Raju   | Manager     | Loan    |
|    102 | Sham   | Cashier     | Cash    |
|    103 | Paul   | Associate   | Loan    |
|    104 | Alex   | Accountant  | Account |
|    105 | Victor | Associate   | Deposit |
+--------+--------+-------------+---------+
5 rows in set (0.00 sec)


Q. Display only emp_id and name of employee:


mysql> SELECT emp_id,name FROM employees;
+--------+--------+
| emp_id | name   |
+--------+--------+
|    101 | Raju   |
|    102 | Sham   |
|    103 | Paul   |
|    104 | Alex   |
|    105 | Victor |
+--------+--------+
5 rows in set (0.00 sec)


************************************************************************************************************************************************************************
*                             *
*    Exercise 02              *
*                             *
*******************************

Q. Display the data
mysql> SELECT * FROM employees WHERE dept='Loan';
+--------+------+-------------+------+
| emp_id | name | designation | dept |
+--------+------+-------------+------+
|    101 | Raju | Manager     | Loan |
|    103 | Paul | Associate   | Loan |
+--------+------+-------------+------+
2 rows in set (0.00 sec)

Q.
mysql> SELECT * FROM employees WHERE emp_id=101;
+--------+------+-------------+------+
| emp_id | name | designation | dept |
+--------+------+-------------+------+
|    101 | Raju | Manager     | Loan |
+--------+------+-------------+------+
1 row in set (0.00 sec)


Q.
mysql> SELECT emp_id,name FROM employees WHERE name='Raju';
+--------+------+
| emp_id | name |
+--------+------+
|    101 | Raju |
+--------+------+
1 row in set (0.00 sec)

mysql> SELECT emp_id,name FROM employees WHERE emp_id=101;
+--------+------+
| emp_id | name |
+--------+------+
|    101 | Raju |
+--------+------+
1 row in set (0.00 sec)

Q. Update dept of Paul from Loan to it

mysql> UPDATE employees SET dept='IT' WHERE emp_id=103;
Query OK, 1 row affected (0.02 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM employees;
+--------+--------+-------------+---------+
| emp_id | name   | designation | dept    |
+--------+--------+-------------+---------+
|    101 | Raju   | Manager     | Loan    |
|    102 | Sham   | Cashier     | Cash    |
|    103 | Paul   | Associate   | IT      |
|    104 | Alex   | Accountant  | Account |
|    105 | Victor | Associate   | Deposit |
+--------+--------+-------------+---------+
5 rows in set (0.00 sec)


Q. Delete the record of Sham

mysql> DELETE FROM employees WHERE name='Sham';
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM employees;
+--------+--------+-------------+---------+
| emp_id | name   | designation | dept    |
+--------+--------+-------------+---------+
|    101 | Raju   | Manager     | Loan    |
|    103 | Paul   | Associate   | IT      |
|    104 | Alex   | Accountant  | Account |
|    105 | Victor | Associate   | Deposit |
+--------+--------+-------------+---------+
4 rows in set (0.00 sec)


************************************************************************************************************************************************************************
*                             *
* 18. String Functions        *
*                             *
*******************************

1. CONCAT Function:

syntax: CONCAT(first_col, sec_col)
  OR    CONCAT(first_word, sec_word )

Using with words:
mysql> SELECT CONCAT('Good',' ','Morning') AS 'Greet';
+--------------+
| Greet        |
+--------------+
| Good Morning |
+--------------+
1 row in set (0.00 s)


Using with table:

Consider below table:
+--------+--------+-------------+---------+----------+
| emp_id | name   | designation | dept    | lastname |
+--------+--------+-------------+---------+----------+
|    101 | Raju   | Manager     | Loan    | Sharma   |
|    103 | Paul   | Associate   | IT      | Verma    |
|    104 | Alex   | Accountant  | Account | Rajput   |
|    105 | Victor | Associate   | Deposit | Corse    |
+--------+--------+-------------+---------+----------+

Concatenate  name and last name as Full name 
mysql> SELECT CONCAT(name,lastname) AS 'Full Name' FROM employees;
+-------------+
| Full Name   |
+-------------+
| RajuSharma  |
| PaulVerma   |
| AlexRajput  |
| VictorCorse |
+-------------+
4 rows in set (0.00 sec)

Mention Fullname with emp_id:

mysql> SELECT emp_id,CONCAT(name,' ',lastname) AS 'Full Name' FROM employees;
+--------+--------------+
| emp_id | Full Name    |
+--------+--------------+
|    101 | Raju Sharma  |
|    103 | Paul Verma   |
|    104 | Alex Rajput  |
|    105 | Victor Corse |
+--------+--------------+
4 rows in set (0.00 sec)



2. CONCAT_WS: ws means with separator
syntax: CONCAT_WS('-', name,lastname)

mysql> Select CONCAT_WS('-', name, lastname) AS 'Separator' from employees;
+--------------+
| Separator    |
+--------------+
| Raju-Sharma  |
| Paul-Verma   |
| Alex-Rajput  |
| Victor-Corse |
+--------------+
4 rows in set (0.00 sec)


mysql> SELECT CONCAT_WS(':', emp_id,name,designation,dept,lastname) from employees;
+-------------------------------------------------------+
| CONCAT_WS(':', emp_id,name,designation,dept,lastname) |
+-------------------------------------------------------+
| 101:Raju:Manager:Loan:Sharma                          |
| 103:Paul:Associate:IT:Verma                           |
| 104:Alex:Accountant:Account:Rajput                    |
| 105:Victor:Associate:Deposit:Corse                    |
+-------------------------------------------------------+
4 rows in set (0.00 sec)



3. SUBSTRING:
SUBSTRING('Hey Buddy',1,4);

mysql> select SUBSTRING('Hello Budddy', 1,4);
+--------------------------------+
| SUBSTRING('Hello Budddy', 1,4) |
+--------------------------------+
| Hell                           |
+--------------------------------+
1 row in set (0.00 sec)

mysql> select SUBSTRING('Hello Budddy', 1,6);
+--------------------------------+
| SUBSTRING('Hello Budddy', 1,6) |
+--------------------------------+
| Hello                          |
+--------------------------------+
1 row in set (0.00 sec)



mysql> select SUBSTRING('Hello Buddy', 7);
+-----------------------------+
| SUBSTRING('Hello Buddy', 7) |
+-----------------------------+
| Buddy                       |
+-----------------------------+
1 row in set (0.00 sec)


mysql> select SUBSTRING('Hello Buddy Raju',-4);
+----------------------------------+
| SUBSTRING('Hello Buddy Raju',-4) |
+----------------------------------+
| Raju                             |
+----------------------------------+
1 row in set (0.00 sec)


mysql> SELECT SUBSTRING(emp_id,2), name,lastname from employees;
+---------------------+--------+----------+
| SUBSTRING(emp_id,2) | name   | lastname |
+---------------------+--------+----------+
| 01                  | Raju   | Sharma   |
| 03                  | Paul   | Verma    |
| 04                  | Alex   | Rajput   |
| 05                  | Victor | Corse    |
+---------------------+--------+----------+
4 rows in set (0.00 sec)


4. REPLACE:
REPLACE(str, from_str, to_str)
Replace('Hey Buddy','Hey','Hello')

mysql> SELECT REPLACE('ABCDPQR', 'PQR', 'XYZ');
+----------------------------------+
| REPLACE('ABCDPQR', 'PQR', 'XYZ') |
+----------------------------------+
| ABCDXYZ                          |
+----------------------------------+
1 row in set (0.00 sec)

mysql> SELECT REPLACE(emp_id, 10,1000) from employees;
+--------------------------+
| REPLACE(emp_id, 10,1000) |
+--------------------------+
| 10001                    |
| 10003                    |
| 10004                    |
| 10005                    |
+--------------------------+
4 rows in set (0.00 sec)



mysql> SELECT REPLACE(emp_id, 10, 'EMP'),name from employees;
+----------------------------+--------+
| REPLACE(emp_id, 10, 'EMP') | name   |
+----------------------------+--------+
| EMP1                       | Raju   |
| EMP3                       | Paul   |
| EMP4                       | Alex   |
| EMP5                       | Victor |
+----------------------------+--------+
4 rows in set (0.00 sec)




************************************************************************************************************************************************************************
*                             *
* Excercise 3                 *
*                             *
*******************************

Q1. Display 101:Raju:Manager:Loan

+-------------------------------------------------+
| CONCAT_WS(':', emp_id, name, designation, dept) |
+-------------------------------------------------+
| 101:Raju:Manager:Loan                           |
+-------------------------------------------------+
1 row in set (0.00 sec)


Q2. 101:Raju Sharma:Manager:Loan

mysql> SELECT CONCAT_WS(':',emp_id,CONCAT(name,' ',lastname),designation,dept) FROM employees WHERE emp_id=101;
+------------------------------------------------------------------+
| CONCAT_WS(':',emp_id,CONCAT(name,' ',lastname),designation,dept) |
+------------------------------------------------------------------+
| 101:Raju Sharma:Manager:Loan                                     |
+------------------------------------------------------------------+
1 row in set (0.00 sec)


Q3. 101:Raju:MANAGER:Loan

mysql> SELECT CONCAT_WS(':',emp_id,name,UPPER(designation),dept) FROM employees WHERE emp_id=101;
+----------------------------------------------------+
| CONCAT_WS(':',emp_id,name,UPPER(designation),dept) |
+----------------------------------------------------+
| 101:Raju:MANAGER:Loan                              |
+----------------------------------------------------+
1 row in set (0.00 sec)


Q4. L101 Raju
    C103 Paul

mysql> SELECT CONCAT(SUBSTRING(dept,1,1),emp_id),name from employees limit 2;
+------------------------------------+------+
| CONCAT(SUBSTRING(dept,1,1),emp_id) | name |
+------------------------------------+------+
| L101                               | Raju |
| I103                               | Paul |
+------------------------------------+------+
2 rows in set (0.00 sec)





************************************************************************************************************************************************************************
*                             *
* 19. Distinct Keyword        * * To retrieve unique values from column.
*                             * * Can retieve multiple column
*******************************

Data:

mysql> select * from employees;
+--------+--------+-------------+------------+-----------+
| emp_id | name   | designation | dept       | lastname  |
+--------+--------+-------------+------------+-----------+
|    101 | Raju   | Manager     | Loan       | Sharma    |
|    103 | Paul   | Associate   | IT         | Verma     |
|    104 | Alex   | Accountant  | Account    | Rajput    |
|    105 | Victor | Associate   | Deposit    | Corse     |
|    106 | Akshay | Manager     | IT         | kadam     |
|    107 | Pravin | Lead        | IT         | Gartadkar |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |
|    109 | Vishu  | Lead        | Deposit    | Rick      |
|    110 | Shan   | Peon        | Staff      | Patil     |
|    111 | Manish | Associate   | Operations | Patil     |
+--------+--------+-------------+------------+-----------+
10 rows in set (0.00 sec)


Unique designation:

mysql> SELECT DISTINCT designation FROM employees;
+-------------+
| designation |
+-------------+
| Manager     |
| Associate   |
| Accountant  |
| Lead        |
| Cashier     |
| Peon        |
+-------------+
6 rows in set (0.00 sec)


Unique dept:
mysql> SELECT DISTINCT dept FROM employees;
+------------+
| dept       |
+------------+
| Loan       |
| IT         |
| Account    |
| Deposit    |
| Staff      |
| Operations |
+------------+
6 rows in set (0.00 sec)


************************************************************************************************************************************************************************
*                             *
* 20. Order by                * * Use for sorting
*                             *
*******************************
Syntax: SELECT * FROM table_name ORDER BY column_name;
Ascending sorting:

mysql> SELECT * FROM employees ORDER BY name;
+--------+--------+-------------+------------+-----------+
| emp_id | name   | designation | dept       | lastname  |
+--------+--------+-------------+------------+-----------+
|    106 | Akshay | Manager     | IT         | kadam     |
|    104 | Alex   | Accountant  | Account    | Rajput    |
|    111 | Manish | Associate   | Operations | Patil     |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |
|    103 | Paul   | Associate   | IT         | Verma     |
|    107 | Pravin | Lead        | IT         | Gartadkar |
|    101 | Raju   | Manager     | Loan       | Sharma    |
|    110 | Shan   | Peon        | Staff      | Patil     |
|    105 | Victor | Associate   | Deposit    | Corse     |
|    109 | Vishu  | Lead        | Deposit    | Rick      |
+--------+--------+-------------+------------+-----------+
10 rows in set (0.00 sec)

Descending Sorting:

mysql> SELECT * FROM employees ORDER BY name DESC;
+--------+--------+-------------+------------+-----------+
| emp_id | name   | designation | dept       | lastname  |
+--------+--------+-------------+------------+-----------+
|    109 | Vishu  | Lead        | Deposit    | Rick      |
|    105 | Victor | Associate   | Deposit    | Corse     |
|    110 | Shan   | Peon        | Staff      | Patil     |
|    101 | Raju   | Manager     | Loan       | Sharma    |
|    107 | Pravin | Lead        | IT         | Gartadkar |
|    103 | Paul   | Associate   | IT         | Verma     |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |
|    111 | Manish | Associate   | Operations | Patil     |
|    104 | Alex   | Accountant  | Account    | Rajput    |
|    106 | Akshay | Manager     | IT         | kadam     |
+--------+--------+-------------+------------+-----------+
10 rows in set (0.00 sec)


Sorting 2 Columns:


mysql> SELECT dept,name FROM employees ORDER BY dept,name;
+------------+--------+
| dept       | name   |
+------------+--------+
| Account    | Alex   |
| Account    | Mayur  |
| Deposit    | Victor |
| Deposit    | Vishu  |
| IT         | Akshay |
| IT         | Paul   |
| IT         | Pravin |
| Loan       | Raju   |
| Operations | Manish |
| Staff      | Shan   |
+------------+--------+
10 rows in set (0.00 sec)




************************************************************************************************************************************************************************
*                             *
* 21. LIKE Keyword            *
*                             *
*******************************

mysql> SELECT * FROM employees WHERE designation LIKE "%CASh%";
+--------+-------+-------------+---------+----------+
| emp_id | name  | designation | dept    | lastname |
+--------+-------+-------------+---------+----------+
|    108 | Mayur | Cashier     | Account | Wankhede |
+--------+-------+-------------+---------+----------+
1 row in set (0.00 sec)


*********************************************************

If we want only names having size 4 character:

mysql> SELECT * FROM employees WHERE designation LIKE "C%";
+--------+-------+-------------+---------+----------+
| emp_id | name  | designation | dept    | lastname |
+--------+-------+-------------+---------+----------+
|    108 | Mayur | Cashier     | Account | Wankhede |
+--------+-------+-------------+---------+----------+
1 row in set (0.00 sec)

*********************************************************
mysql> SELECT * FROM employees WHERE dept LIKE "%rat%";
+--------+--------+-------------+------------+----------+
| emp_id | name   | designation | dept       | lastname |
+--------+--------+-------------+------------+----------+
|    111 | Manish | Associate   | Operations | Patil    |
+--------+--------+-------------+------------+----------+
1 row in set (0.00 sec)


*********************************************************
mysql> SELECT * FROM employees WHERE dept LIKE "%t";
+--------+--------+-------------+---------+-----------+
| emp_id | name   | designation | dept    | lastname  |
+--------+--------+-------------+---------+-----------+
|    103 | Paul   | Associate   | IT      | Verma     |
|    104 | Alex   | Accountant  | Account | Rajput    |
|    105 | Victor | Associate   | Deposit | Corse     |
|    106 | Akshay | Manager     | IT      | kadam     |
|    107 | Pravin | Lead        | IT      | Gartadkar |
|    108 | Mayur  | Cashier     | Account | Wankhede  |
|    109 | Vishu  | Lead        | Deposit | Rick      |
+--------+--------+-------------+---------+-----------+
7 rows in set (0.00 sec)


*********************************************************

mysql> SELECT * FROM employees WHERE name LIKE "____" ;
+--------+------+-------------+---------+----------+
| emp_id | name | designation | dept    | lastname |
+--------+------+-------------+---------+----------+
|    101 | Raju | Manager     | Loan    | Sharma   |
|    103 | Paul | Associate   | IT      | Verma    |
|    104 | Alex | Accountant  | Account | Rajput   |
|    110 | Shan | Peon        | Staff   | Patil    |
+--------+------+-------------+---------+----------+
4 rows in set (0.00 sec)



*********************************************************

If we want only names having size 7 character:
mysql> SELECT * FROM employees WHERE designation LIKE "_______" ;
+--------+--------+-------------+---------+----------+
| emp_id | name   | designation | dept    | lastname |
+--------+--------+-------------+---------+----------+
|    101 | Raju   | Manager     | Loan    | Sharma   |
|    106 | Akshay | Manager     | IT      | kadam    |
|    108 | Mayur  | Cashier     | Account | Wankhede |
+--------+--------+-------------+---------+----------+
3 rows in set (0.00 sec)

*****************************************************************

mysql> SELECT * FROM employees WHERE designation LIKE "M______" ;
+--------+--------+-------------+------+----------+
| emp_id | name   | designation | dept | lastname |
+--------+--------+-------------+------+----------+
|    101 | Raju   | Manager     | Loan | Sharma   |
|    106 | Akshay | Manager     | IT   | kadam    |
+--------+--------+-------------+------+----------+
2 rows in set (0.00 sec)









************************************************************************************************************************************************************************
*                             *
* 22. Limit                   *
*                             *
*******************************
Added new column SALARY in previous data:
mysql> ALTER TABLE employees ADD COLUMN SALARY INT NOT NULL DEFAULT 25000;
Query OK, 0 rows affected (0.10 sec)
Records: 0  Duplicates: 0  Warnings: 0


mysql> SELECT * FROM employees;
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma    |  25000 |
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    104 | Alex   | Accountant  | Account    | Rajput    |  25000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  25000 |
|    106 | Akshay | Manager     | IT         | kadam     |  25000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  25000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |  25000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  25000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  25000 |
|    111 | Manish | Associate   | Operations | Patil     |  25000 |
+--------+--------+-------------+------------+-----------+--------+
10 rows in set (0.00 sec)

mysql> SELECT * FROM employees LIMIt 4;
+--------+--------+-------------+---------+----------+--------+
| emp_id | name   | designation | dept    | lastname | SALARY |
+--------+--------+-------------+---------+----------+--------+
|    101 | Raju   | Manager     | Loan    | Sharma   |  25000 |
|    103 | Paul   | Associate   | IT      | Verma    |  25000 |
|    104 | Alex   | Accountant  | Account | Rajput   |  25000 |
|    105 | Victor | Associate   | Deposit | Corse    |  25000 |
+--------+--------+-------------+---------+----------+--------+
4 rows in set (0.00 sec)

Finding highest salary using limit and order by:

mysql> SELECT * FROM employees ORDER BY SALARY DESC LIMIT 1;
+--------+--------+-------------+------+-----------+--------+
| emp_id | name   | designation | dept | lastname  | SALARY |
+--------+--------+-------------+------+-----------+--------+
|    107 | Pravin | Lead        | IT   | Gartadkar |  70000 |
+--------+--------+-------------+------+-----------+--------+
1 row in set (0.01 sec)
S



************************************************************************************************************************************************************************
*                             *
* 23. Count Functions         *
*                             *
*******************************

1. count Function;

To check number of records in a table:

mysql> SELECT COUNT(*) FROM EMPLOYEES;
+----------+
| COUNT(*) |
+----------+
|       10 |
+----------+
1 row in set (0.04 sec)

Using DISTINCT and COUNT together:

mysql> SELECT COUNT(DISTINCT dept) FROM EMPLOYEES;
+----------------------+
| COUNT(DISTINCT dept) |
+----------------------+
|                    6 |
+----------------------+
1 row in set (0.00 sec)

Using count with WHERE condition.

mysql> SELECT COUNT(dept) FROM employees WHERE dept = 'IT';
+-------------+
| COUNT(dept) |
+-------------+
|           3 |
+-------------+
1 row in set (0.01 sec)


Count number of Manager in table:

mysql> SELECT COUNT(designation) FROM employees WHERE designation = 'Manager';
+--------------------+
| COUNT(designation) |
+--------------------+
|                  2 |
+--------------------+
1 row in set (0.00 sec)




************************************************************************************************************************************************************************
*                             *
*  Excercise 04               *
*                             *
*******************************

mysql> SELECT * FROM employees;
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma    |  25000 |
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    104 | Alex   | Accountant  | Account    | Rajput    |  25000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  25000 |
|    106 | Akshay | Manager     | IT         | kadam     |  25000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  25000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |  25000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  25000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  25000 |
|    111 | Manish | Associate   | Operations | Patil     |  25000 |
+--------+--------+-------------+------------+-----------+--------+
10 rows in set (0.00 sec)


Q1. Find different types of departments in table:

mysql> SELECT DISTINCT(dept) FROM employees;
+------------+
| dept       |
+------------+
| Loan       |
| IT         |
| Account    |
| Deposit    |
| Staff      |
| Operations |
+------------+
6 rows in set (0.00 sec)

*************************************************************************

Q2. Display records with high to low salary:

mysql> SELECT * FROM employees ORDER BY SALARY DESC;
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    107 | Pravin | Lead        | IT         | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  70000 |
|    106 | Akshay | Manager     | IT         | kadam     |  50000 |
|    104 | Alex   | Accountant  | Account    | Rajput    |  45000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |  45000 |
|    111 | Manish | Associate   | Operations | Patil     |  45000 |
|    101 | Raju   | Manager     | Loan       | Sharma    |  30000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  30000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  30000 |
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
+--------+--------+-------------+------------+-----------+--------+
10 rows in set (0.00 sec)


************************************************************************

Q3. How to see only top 3 records from a table?

mysql> SELECT * FROM employees LIMIT 3:
+--------+------+-------------+---------+----------+--------+
| emp_id | name | designation | dept    | lastname | SALARY |
+--------+------+-------------+---------+----------+--------+
|    101 | Raju | Manager     | Loan    | Sharma   |  30000 |
|    103 | Paul | Associate   | IT      | Verma    |  25000 |
|    104 | Alex | Accountant  | Account | Rajput   |  45000 |
+--------+------+-------------+---------+----------+--------+
3 rows in set (0.00 sec)


***************************************************************************

Q4. Show records where first name start with letter 'A':

mysql> SELECT * FROM employees WHERE name LIKE "A%";
+--------+--------+-------------+---------+----------+--------+
| emp_id | name   | designation | dept    | lastname | SALARY |
+--------+--------+-------------+---------+----------+--------+
|    104 | Alex   | Accountant  | Account | Rajput   |  45000 |
|    106 | Akshay | Manager     | IT      | kadam    |  50000 |
+--------+--------+-------------+---------+----------+--------+
2 rows in set (0.00 sec)


**********************************************************************

Q5. Show records where length of the lname is 4 character:

mysql> SELECT * FROM employees WHERE lastname LIKE "____";
+--------+-------+-------------+---------+----------+--------+
| emp_id | name  | designation | dept    | lastname | SALARY |
+--------+-------+-------------+---------+----------+--------+
|    109 | Vishu | Lead        | Deposit | Rick     |  30000 |
+--------+-------+-------------+---------+----------+--------+
1 row in set (0.00 sec)

 
*************************************************************************************************************************************************************************
*                             *
*  24.Group By Clause         *
*                             *
*******************************



mysql> SELECT dept FROM employees GROUP BY dept;
+------------+
| dept       |
+------------+
| Loan       |
| IT         |
| Account    |
| Deposit    |
| Staff      |
| Operations |
+------------+
6 rows in set (0.00 sec)

mysql> SELECT dept, COUNT(emp_id) FROM employees GROUP BY dept;
+------------+---------------+
| dept       | COUNT(emp_id) |
+------------+---------------+
| Loan       |             1 |
| IT         |             3 |
| Account    |             2 |
| Deposit    |             2 |
| Staff      |             1 |
| Operations |             1 |
+------------+---------------+
6 rows in set (0.00 sec)


Q.Group employees by designation and check number of employee having same designation.

mysql> SELECT designation, COUNT(emp_id) FROM employees GROUP BY designation;
+-------------+---------------+
| designation | COUNT(emp_id) |
+-------------+---------------+
| Manager     |             2 |
| Associate   |             3 |
| Accountant  |             1 |
| Lead        |             2 |
| Cashier     |             1 |
| Peon        |             1 |
+-------------+---------------+
6 rows in set (0.00 sec)

Q. Display number of employees having same salary group by salary.

mysql> SELECT SALARY,COUNT(emp_id)  FROM employees GROUP BY SALARY;
+--------+---------------+
| SALARY | COUNT(emp_id) |
+--------+---------------+
|  30000 |             3 |
|  25000 |             1 |
|  45000 |             3 |
|  50000 |             1 |
|  70000 |             2 |
+--------+---------------+
5 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*  25. Max Function           *
*                             *
*******************************



mysql> SELECT MAX(SALARY) FROM employees;
+-------------+
| MAX(SALARY) |
+-------------+
|       70000 |
+-------------+
1 row in set (0.00 sec)


Using with String Columns: returns highest alphabet.

mysql> SELECT MAX(name) FROM employees;
+-----------+
| MAX(name) |
+-----------+
| Vishu     |
+-----------+
1 row in set (0.00 sec)

*************************************************************************************************************************************************************************
*                             *
*  26. Min                    *
*                             *
*******************************



mysql> SELECT MIN(SALARY) FROM employees;
+-------------+
| MIN(SALARY) |
+-------------+
|       25000 |
+-------------+
1 row in set (0.00 sec)


Using with String Columns: returns lowest alphabet.

mysql> SELECT MIN(name) FROM employees;
+-----------+
| MIN(name) |
+-----------+
| Akshay    |
+-----------+
1 row in set (0.00 sec)

*************************************************************************************************************************************************************************
*                             *
*  27. Subqueries             * First bracket query will get executed then 
*                             * other Query will get execute.
*******************************

Find highest salary and display the details of that employees:

mysql> SELECT * FROM employees WHERE SALARY=(SELECT MAX(SALARY) FROM employees);
+--------+--------+-------------+-------+-----------+--------+
| emp_id | name   | designation | dept  | lastname  | SALARY |
+--------+--------+-------------+-------+-----------+--------+
|    107 | Pravin | Lead        | IT    | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff | Patil     |  70000 |
+--------+--------+-------------+-------+-----------+--------+
2 rows in set (0.01 sec)




*************************************************************************************************************************************************************************
*                             *
*  28. SUM                    *
*                             *
*******************************


mysql> SELECT SUM(SALARY) FROM employees;
+-------------+
| SUM(SALARY) |
+-------------+
|      440000 |
+-------------+
1 row in set (0.00 sec)


mysql> SELECT  dept, SUM(SALARY),COUNT(emp_id) FROM employees GROUP BY dept;
+------------+-------------+---------------+
| dept       | SUM(SALARY) | COUNT(emp_id) |
+------------+-------------+---------------+
| Loan       |       30000 |             1 |
| IT         |      145000 |             3 |
| Account    |       90000 |             2 |
| Deposit    |       60000 |             2 |
| Staff      |       70000 |             1 |
| Operations |       45000 |             1 |
+------------+-------------+---------------+
6 rows in set (0.00 sec)



*************************************************************************************************************************************************************************
*                             *
*  29. AVG                    *
*                             *
*******************************


mysql> SELECT AVG(SALARY) FROM employees;
+-------------+
| AVG(SALARY) |
+-------------+
|  44000.0000 |
+-------------+
1 row in set (0.00 sec)

mysql> SELECT  dept, AVG(SALARY) FROM employees GROUP BY dept;
+------------+-------------+
| dept       | AVG(SALARY) |
+------------+-------------+
| Loan       |  30000.0000 |
| IT         |  48333.3333 |
| Account    |  45000.0000 |
| Deposit    |  30000.0000 |
| Staff      |  70000.0000 |
| Operations |  45000.0000 |
+------------+-------------+
6 rows in set (0.04 sec)



*************************************************************************************************************************************************************************
*                             *
*     Exercise 05             *
*                             *
*******************************


Q1. Find total number of employees in database:

mysql> SELECT COUNT(emp_id) FROM employees;
+---------------+
| COUNT(emp_id) |
+---------------+
|            10 |
+---------------+
1 row in set (0.04 sec)


Q2. Find number of employees in each department:

mysql> SELECT dept, COUNT(emp_id) FROM employees GROUP BY dept;
+------------+---------------+
| dept       | COUNT(emp_id) |
+------------+---------------+
| Loan       |             1 |
| IT         |             3 |
| Account    |             2 |
| Deposit    |             2 |
| Staff      |             1 |
| Operations |             1 |
+------------+---------------+
6 rows in set (0.00 sec)


Q3. Find Lowest salary paying:

mysql> SELECT MIN(SALARY) FROM employees;
+-------------+
| MIN(SALARY) |
+-------------+
|       25000 |
+-------------+
1 row in set (0.00 sec)

mysql> SELECT * FROM employees WHERE SALARY=(SELECT MIN(SALARY) FROM employees);
+--------+------+-------------+------+----------+--------+
| emp_id | name | designation | dept | lastname | SALARY |
+--------+------+-------------+------+----------+--------+
|    103 | Paul | Associate   | IT   | Verma    |  25000 |
+--------+------+-------------+------+----------+--------+
1 row in set (0.00 sec)


Q4. Find Highest salary paying:

mysql> SELECT MAX(SALARY) FROM employees;
+-------------+
| MAX(SALARY) |
+-------------+
|       70000 |
+-------------+
1 row in set (0.00 sec)

mysql> SELECT * FROM employees WHERE SALARY=(SELECT MAX(SALARY) FROM employees);
+--------+--------+-------------+-------+-----------+--------+
| emp_id | name   | designation | dept  | lastname  | SALARY |
+--------+--------+-------------+-------+-----------+--------+
|    107 | Pravin | Lead        | IT    | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff | Patil     |  70000 |
+--------+--------+-------------+-------+-----------+--------+
2 rows in set (0.00 sec)


Q5. Find total salary paying in IT department:

mysql> SELECT SUM(SALARY) FROM employees WHERE dept= 'IT';
+-------------+
| SUM(SALARY) |
+-------------+
|      145000 |
+-------------+
1 row in set (0.00 sec)


Q6. Average Salary Paying in each department:

mysql> SELECT dept, AVG(SALARY) FROM employees GROUP BY dept;
+------------+-------------+
| dept       | AVG(SALARY) |
+------------+-------------+
| Loan       |  30000.0000 |
| IT         |  48333.3333 |
| Account    |  45000.0000 |
| Deposit    |  30000.0000 |
| Staff      |  70000.0000 |
| Operations |  45000.0000 |
+------------+-------------+
6 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*   30. Decimal Datatype      *
*                             * 
******************************* 
 # In INT datatype we can not store flot value there we use decimal type.
 # Max number of digits for DECIMAL is 65.

 # e.g DECIMAL(5,2): Here 5 is Total Digits including digits after decimal.
                  2 is digits after decimal point.
 # The total digits in whole price should be 5 

mysql>
mysql> CREATE TABLE dec_num( price DECIMAL(5,2));
Query OK, 0 rows affected (0.07 sec)

mysql> DESC dec_num;
+-------+--------------+------+-----+---------+-------+
| Field | Type         | Null | Key | Default | Extra |
+-------+--------------+------+-----+---------+-------+
| price | decimal(5,2) | YES  |     | NULL    |       |
+-------+--------------+------+-----+---------+-------+
1 row in set (0.02 sec)

mysql> INSERT INTO dec_num VALUES(123.12);
Query OK, 1 row affected (0.02 sec)

mysql> INSERT INTO dec_num VALUES(12.123);
Query OK, 1 row affected, 1 warning (0.01 sec)

mysql> INSERT INTO dec_num VALUES(12.12);
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM dec_num;
+--------+
| price  |
+--------+
| 556.22 |
| 123.12 |
|   1.1  |
|  12.12 |
|  12.12 |
+--------+
5 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*   31. Float Datatype        *
*                             *
*******************************
Float: upto 7 digits, takes 4 bytes of memory




*************************************************************************************************************************************************************************
*                             *
*   32. Double datatype       *
*                             *
*******************************
Double: upto 15 digits, takes 8 bytes of memory


mysql> CREATE TABLE FLO_DOUB(f_value FLOAT, d_value DOUBLE);
Query OK, 0 rows affected (0.04 sec)

mysql> DESC FLO_DOUB;
+---------+--------+------+-----+---------+-------+
| Field   | Type   | Null | Key | Default | Extra |
+---------+--------+------+-----+---------+-------+
| f_value | float  | YES  |     | NULL    |       |
| d_value | double | YES  |     | NULL    |       |
+---------+--------+------+-----+---------+-------+
2 rows in set (0.02 sec)

mysql> INSERT INTO FLO_DOUB VALUES(123.456, 123.456);
Query OK, 1 row affected (0.01 sec)

mysql> INSERT INTO FLO_DOUB VALUES(123.123456789, 123.123456789);
Query OK, 1 row affected (0.01 sec)

mysql> INSERT INTO FLO_DOUB VALUES(123.123456789101112, 123.12345678910111213);

mysql> SELECT * FROM FLO_DOUB;
+---------+--------------------+
| f_value | d_value            |
+---------+--------------------+
| 123.456 |            123.456 |
| 123.123 |      123.123456789 |
| 123.123 | 123.12345678910111 |
+---------+--------------------+
3 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*   33. Date Time Datatype    *
*                             *
*******************************

1. DATE     : format: yyyy-mm-dd
2. TIME     : format: HH:MM:SS 
3. DATETIME : format: 'yyyy-mm-dd HH:MM:SS'


mysql> CREATE TABLE person(
    -> jd DATE,
    -> jt TIME,
    -> jdt DATETIME);
Query OK, 0 rows affected (0.03 sec)

mysql> DESC person;
+-------+----------+------+-----+---------+-------+
| Field | Type     | Null | Key | Default | Extra |
+-------+----------+------+-----+---------+-------+
| jd    | date     | YES  |     | NULL    |       |
| jt    | time     | YES  |     | NULL    |       |
| jdt   | datetime | YES  |     | NULL    |       |
+-------+----------+------+-----+---------+-------+
3 rows in set (0.01 sec)

mysql> SELECT * FROM person;
+------------+----------+---------------------+
| jd         | jt       | jdt                 |
+------------+----------+---------------------+
| 1997-04-21 | 12:05:12 | 1997-04-21 12:05:12 |
+------------+----------+---------------------+
1 row in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*     34. DATETIME Functions  *
*                             *
*******************************

1. CURDATE() : yyyy-mm-dd
mysql> SELECT CURDATE();
+------------+
| CURDATE()  |
+------------+
| 2024-09-20 |
+------------+
1 row in set (0.01 sec)

2. CURTIME() : hh:mm:SS
mysql> SELECT CURTIME();
+-----------+
| CURTIME() |
+-----------+
| 12:33:29  |
+-----------+
1 row in set (0.01 sec)

3. NOW() : yyyy-mm-dd hh:mm:SS
mysql> SELECT NOW();
+---------------------+
| NOW()               |
+---------------------+
| 2024-09-20 12:33:33 |
+---------------------+
1 row in set (0.00 sec)

Suppose a person joined today lets add his record to our person table:

mysql> INSERT INTO person VALUES(CURDATE(), CURTIME(), NOW());
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM person;
+------------+----------+---------------------+
| jd         | jt       | jdt                 |
+------------+----------+---------------------+
| 1997-04-21 | 12:05:12 | 1997-04-21 12:05:12 |
| 2024-09-20 | 12:35:39 | 2024-09-20 12:35:39 |
+------------+----------+---------------------+
2 rows in set (0.00 sec)


4. DAYNAME(): 
mysql> SELECT DAYNAME('1997-04-21');
+-----------------------+
| DAYNAME('1997-04-21') |
+-----------------------+
| Monday                |
+-----------------------+
1 row in set (0.00 sec)

5. DAYOFMONTH():
mysql> SELECT DAYOFMONTH('1997-04-21');
+--------------------------+
| DAYOFMONTH('1997-04-21') |
+--------------------------+
|                       21 |
+--------------------------+
1 row in set (0.00 sec)

6. DAYOFWEEK():
mysql> SELECT DAYOFWEEK('1997-04-21');
+-------------------------+
| DAYOFWEEK('1997-04-21') |
+-------------------------+
|                       2 |
+-------------------------+
1 row in set (0.00 sec) 

7. MONTHNAME():
mysql> SELECT MONTHNAME('1997-04-21');
+-------------------------+
| MONTHNAME('1997-04-21') |
+-------------------------+
| April                   |
+-------------------------+
1 row in set (0.01 sec)

Using functions with person table:
mysql> SELECT jd, MONTHNAME(jd) FROM person;
+------------+---------------+
| jd         | MONTHNAME(jd) |
+------------+---------------+
| 1997-04-21 | April         |
| 2024-09-20 | September     |
+------------+---------------+
2 rows in set (0.00 sec)


8. HOUR():
mysql> SELECT HOUR('15:03:56');
+------------------+
| HOUR('15:03:56') |
+------------------+
|               15 |
+------------------+
1 row in set (0.00 sec)


mysql> SELECT jt, HOUR(jt) FROM person;
+----------+----------+
| jt       | HOUR(jt) |
+----------+----------+
| 12:05:12 |       12 |
| 12:35:39 |       12 |
+----------+----------+
2 rows in set (0.00 sec)


9. MINUTE():
mysql> SELECT MINUTE('15:03:56');
+--------------------+
| MINUTE('15:03:56') |
+--------------------+
|                  3 |
+--------------------+
1 row in set (0.00 sec)


mysql> SELECT jt, MINUTE(jt) FROM person;
+----------+------------+
| jt       | MINUTE(jt) |
+----------+------------+
| 12:05:12 |          5 |
| 12:35:39 |         35 |
+----------+------------+
2 rows in set (0.00 sec)


10. DATE_FORMAT(Date, Format):

# Suppose we need to get date in a given format like,
  Tue Mar 28th
  21st Tue at 21:20:28
  2023/04/18

  DATE_FORMAT(now(), '%D %a at %T')

  DATE_FORMAT(now(), '%m/%d/%y')

mysql> SELECT DATE_FORMAT(now(),'%D %a at %T');
+----------------------------------+
| DATE_FORMAT(now(),'%D %a at %T') |
+----------------------------------+
| 20th Fri at 16:19:15             |
+----------------------------------+
1 row in set (0.01 sec)

# USing with table

mysql> SELECT jdt, DATE_FORMAT(jdt, '%D %a at %k') FROM person;
+---------------------+---------------------------------+
| jdt                 | DATE_FORMAT(jdt, '%D %a at %k') |
+---------------------+---------------------------------+
| 1997-04-21 12:05:12 | 21st Mon at 12                  |
| 2024-09-20 12:35:39 | 20th Fri at 12                  |
+---------------------+---------------------------------+
2 rows in set (0.00 sec)


 DATE Maths:

11. DATEDIFF(expr1, expr2)

mysql> SELECT DATEDIFF('2023-04-20', '2023-04-10');
+--------------------------------------+
| DATEDIFF('2023-04-20', '2023-04-10') |
+--------------------------------------+
|                                   10 |
+--------------------------------------+
1 row in set (0.00 sec)


12. DATE_ADD(date, INTERVAL expr unit)

mysql> SELECT DATE_ADD(NOW(),INTERVAL 1 YEAR);
+---------------------------------+
| DATE_ADD(NOW(),INTERVAL 1 YEAR) |
+---------------------------------+
| 2025-09-20 16:43:57             |
+---------------------------------+
1 row in set (0.00 sec)


mysql> SELECT DATE_ADD(NOW(),INTERVAL 1 MONTH);
+----------------------------------+
| DATE_ADD(NOW(),INTERVAL 1 MONTH) |
+----------------------------------+
| 2024-10-20 16:44:36              |
+----------------------------------+
1 row in set (0.00 sec)

13. DATE_SUB(date, INTERVAL expr unit)

mysql> SELECT DATE_SUB(NOW(),INTERVAL 1 MONTH);
+----------------------------------+
| DATE_SUB(NOW(),INTERVAL 1 MONTH) |
+----------------------------------+
| 2024-08-20 16:45:02              |
+----------------------------------+
1 row in set (0.00 sec)


14. TIMEDIFF(expr1, expr2) : 
TIMEDIFF('20:00:00','18:00:00')
mysql> SELECT TIMEDIFF('23:00:00', '20:00:00');
+----------------------------------+
| TIMEDIFF('23:00:00', '20:00:00') |
+----------------------------------+
| 03:00:00                         |
+----------------------------------+
1 row in set (0.00 sec)

15. TIMESTAMP():

mysql> CREATE TABLE blogs(
    -> blog VARCHAR(50),
    -> ct DATETIME DEFAULT CURRENT_TIMESTAMP,
    -> ut DATETIME ON UPDATE CURRENT_TIMESTAMP);
Query OK, 0 rows affected (0.05 sec)

mysql> DESC blogs;
+-------+-------------+------+-----+-------------------+-----------------------------+
| Field | Type        | Null | Key | Default           | Extra                       |
+-------+-------------+------+-----+-------------------+-----------------------------+
| blog  | varchar(50) | YES  |     | NULL              |                             |
| ct    | datetime    | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED           |
| ut    | datetime    | YES  |     | NULL              | on update CURRENT_TIMESTAMP |
+-------+-------------+------+-----+-------------------+-----------------------------+
3 rows in set (0.02 sec)


mysql> INSERT INTO blogs (blog) VALUES('This is my 1st blog');
Query OK, 1 row affected (0.02 sec)

mysql> SELECT * FROM blogs;
+---------------------+---------------------+------+
| blog                | ct                  | ut   |
+---------------------+---------------------+------+
| This is my 1st blog | 2024-09-20 16:52:36 | NULL |
+---------------------+---------------------+------+
1 row in set (0.00 sec)

mysql> UPDATE blogs set blog='This is updated blog';
Query OK, 1 row affected (0.01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT * FROM blogs;
+----------------------+---------------------+---------------------+
| blog                 | ct                  | ut                  |
+----------------------+---------------------+---------------------+
| This is updated blog | 2024-09-20 16:52:36 | 2024-09-20 16:54:00 |
+----------------------+---------------------+---------------------+
1 row in set (0.00 sec)





*************************************************************************************************************************************************************************
*                             *
*       Exercise 06           *
*                             *
*******************************

Q1. Print the current time(HH:MM:SS)

mysql> Select CURTIME();
+-----------+
| CURTIME() |
+-----------+
| 17:05:06  |
+-----------+
1 row in set (0.00 sec)


Q2. Print the current date(yyyy-mm-dd)

mysql> Select CURDATE();
+------------+
| CURDATE()  |
+------------+
| 2024-09-20 |
+------------+
1 row in set (0.00 sec)

Q3. PRint Current Day of the Week(Monday, Tuesday)

mysql> Select DAYNAME(CURDATE());
+--------------------+
| DAYNAME(CURDATE()) |
+--------------------+
| Friday             |
+--------------------+
1 row in set (0.00 sec)

Q4. Which datatype can be used to store value 123.456?
==> Decimal

Q5. Display Date in format:
    dd:mm:yyyy
mysql> SELECT DATE_FORMAT(CURDATE(), '%d:%c:%Y');
+------------------------------------+
| DATE_FORMAT(CURDATE(), '%d:%c:%Y') |
+------------------------------------+
| 20:9:2024                          |
+------------------------------------+
1 row in set (0.00 sec)

     April 22nd at 22:00:00

 mysql> SELECT DATE_FORMAT(NOW(),'%b%D at %k');
+---------------------------------+
| DATE_FORMAT(NOW(),'%b%D at %k') |
+---------------------------------+
| Sep20th at 17                   |
+---------------------------------+
1 row in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*    35. Relational Operators *
*                             *
*******************************

1. > Greater Than:

mysql> SELECT * FROM employees WHERE SALARY>65000;
+--------+--------+-------------+-------+-----------+--------+
| emp_id | name   | designation | dept  | lastname  | SALARY |
+--------+--------+-------------+-------+-----------+--------+
|    107 | Pravin | Lead        | IT    | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff | Patil     |  70000 |
+--------+--------+-------------+-------+-----------+--------+
2 rows in set (0.00 sec)

2. < Less Than:

mysql> SELECT * FROM employees WHERE SALARY < 65000;
+--------+--------+-------------+------------+----------+--------+
| emp_id | name   | designation | dept       | lastname | SALARY |
+--------+--------+-------------+------------+----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma   |  30000 |
|    103 | Paul   | Associate   | IT         | Verma    |  25000 |
|    104 | Alex   | Accountant  | Account    | Rajput   |  45000 |
|    105 | Victor | Associate   | Deposit    | Corse    |  30000 |
|    106 | Akshay | Manager     | IT         | kadam    |  50000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede |  45000 |
|    109 | Vishu  | Lead        | Deposit    | Rick     |  30000 |
|    111 | Manish | Associate   | Operations | Patil    |  45000 |
+--------+--------+-------------+------------+----------+--------+
8 rows in set (0.00 sec)


3. <= Less Than equal to 

mysql> SELECT * FROM employees WHERE SALARY <= 50000;
+--------+--------+-------------+------------+----------+--------+
| emp_id | name   | designation | dept       | lastname | SALARY |
+--------+--------+-------------+------------+----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma   |  30000 |
|    103 | Paul   | Associate   | IT         | Verma    |  25000 |
|    104 | Alex   | Accountant  | Account    | Rajput   |  45000 |
|    105 | Victor | Associate   | Deposit    | Corse    |  30000 |
|    106 | Akshay | Manager     | IT         | kadam    |  50000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede |  45000 |
|    109 | Vishu  | Lead        | Deposit    | Rick     |  30000 |
|    111 | Manish | Associate   | Operations | Patil    |  45000 |
+--------+--------+-------------+------------+----------+--------+
8 rows in set (0.00 sec)


4. >=  Greater Than equal to:

mysql> SELECT * FROM employees WHERE SALARY >= 50000;
+--------+--------+-------------+-------+-----------+--------+
| emp_id | name   | designation | dept  | lastname  | SALARY |
+--------+--------+-------------+-------+-----------+--------+
|    106 | Akshay | Manager     | IT    | kadam     |  50000 |
|    107 | Pravin | Lead        | IT    | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff | Patil     |  70000 |
+--------+--------+-------------+-------+-----------+--------+
3 rows in set (0.00 sec)



5. != Not Equal to:

mysql> SELECT * FROM employees WHERE SALARY != 30000;
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    104 | Alex   | Accountant  | Account    | Rajput    |  45000 |
|    106 | Akshay | Manager     | IT         | kadam     |  50000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  70000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |  45000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  70000 |
|    111 | Manish | Associate   | Operations | Patil     |  45000 |
+--------+--------+-------------+------------+-----------+--------+
7 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*    35. Logical Operators    *
*                             *
*******************************

1. AND operator:
# When both conditions are true.

mysql> SELECT * FROM employees WHERE SALARY = 30000 AND dept='Deposit';
+--------+--------+-------------+---------+----------+--------+
| emp_id | name   | designation | dept    | lastname | SALARY |
+--------+--------+-------------+---------+----------+--------+
|    105 | Victor | Associate   | Deposit | Corse    |  30000 |
|    109 | Vishu  | Lead        | Deposit | Rick     |  30000 |
+--------+--------+-------------+---------+----------+--------+
2 rows in set (0.00 sec)



2. OR Operstor:
# When either of the condition is true.

mysql> SELECT * FROM employees WHERE SALARY = 30000 OR dept='IT';
+--------+--------+-------------+---------+-----------+--------+
| emp_id | name   | designation | dept    | lastname  | SALARY |
+--------+--------+-------------+---------+-----------+--------+
|    101 | Raju   | Manager     | Loan    | Sharma    |  30000 |
|    103 | Paul   | Associate   | IT      | Verma     |  25000 |
|    105 | Victor | Associate   | Deposit | Corse     |  30000 |
|    106 | Akshay | Manager     | IT      | kadam     |  50000 |
|    107 | Pravin | Lead        | IT      | Gartadkar |  70000 |
|    109 | Vishu  | Lead        | Deposit | Rick      |  30000 |
+--------+--------+-------------+---------+-----------+--------+
6 rows in set (0.00 sec)

mysql> SELECT * FROM employees WHERE SALARY = 30000  OR SALARY=25000 OR SALARY = 70000;
+--------+--------+-------------+---------+-----------+--------+
| emp_id | name   | designation | dept    | lastname  | SALARY |
+--------+--------+-------------+---------+-----------+--------+
|    101 | Raju   | Manager     | Loan    | Sharma    |  30000 |
|    103 | Paul   | Associate   | IT      | Verma     |  25000 |
|    105 | Victor | Associate   | Deposit | Corse     |  30000 |
|    107 | Pravin | Lead        | IT      | Gartadkar |  70000 |
|    109 | Vishu  | Lead        | Deposit | Rick      |  30000 |
|    110 | Shan   | Peon        | Staff   | Patil     |  70000 |
+--------+--------+-------------+---------+-----------+--------+
6 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*  36. IN NOT IN Keywords     *
*                             *
*******************************

1. IN:

mysql> SELECT * FROM employees WHERE dept IN('Account','Cash','Loan');
+--------+-------+-------------+---------+----------+--------+
| emp_id | name  | designation | dept    | lastname | SALARY |
+--------+-------+-------------+---------+----------+--------+
|    101 | Raju  | Manager     | Loan    | Sharma   |  30000 |
|    104 | Alex  | Accountant  | Account | Rajput   |  45000 |
|    108 | Mayur | Cashier     | Account | Wankhede |  45000 |
+--------+-------+-------------+---------+----------+--------+
3 rows in set (0.00 sec)



2. NOT IN:

mysql> SELECT * FROM employees WHERE dept NOT IN('Account','Cash','Loan');
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  30000 |
|    106 | Akshay | Manager     | IT         | kadam     |  50000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  70000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  30000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  70000 |
|    111 | Manish | Associate   | Operations | Patil     |  45000 |
+--------+--------+-------------+------------+-----------+--------+
7 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                             *
*  37. BETWEEN Keyword        *
*                             *
*******************************

mysql> SELECT * FROM employees WHERE SALARY BETWEEN 50000 AND 79000;
+--------+--------+-------------+-------+-----------+--------+
| emp_id | name   | designation | dept  | lastname  | SALARY |
+--------+--------+-------------+-------+-----------+--------+
|    106 | Akshay | Manager     | IT    | kadam     |  50000 |
|    107 | Pravin | Lead        | IT    | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff | Patil     |  70000 |
+--------+--------+-------------+-------+-----------+--------+
3 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                               *
*  38. Case to apply conditions *
*                               *
*********************************

mysql> SELECT
    -> name,
    -> SALARY,
    -> CASE
    ->   WHEN SALARY >= 45000 THEN 'Higher Salary'
    ->   ELSE 'Lower Salary'
    -> END AS 'Salary Category'
    -> FROM employees;

+--------+--------+-----------------+
| name   | SALARY | Salary Category |
+--------+--------+-----------------+
| Raju   |  30000 | Lower Salary    |
| Paul   |  25000 | Lower Salary    |
| Alex   |  45000 | Higher Salary   |
| Victor |  30000 | Lower Salary    |
| Akshay |  50000 | Higher Salary   |
| Pravin |  70000 | Higher Salary   |
| Mayur  |  45000 | Higher Salary   |
| Vishu  |  30000 | Lower Salary    |
| Shan   |  70000 | Higher Salary   |
| Manish |  45000 | Higher Salary   |
+--------+--------+-----------------+
10 rows in set (0.00 sec)


# Multiple conditions:

mysql> SELECT
    -> name,
    -> SALARY,
    -> CASE
    ->   WHEN SALARY >= 50000 THEN 'Higher Salary'
    ->   WHEN SALARY >= 30000 AND SALARY < 50000 THEN 'Mid Salary'
    -> Else 'Lower Salary'
    -> END AS  'SALARY Category'
    -> FROM employees;
+--------+--------+-----------------+
| name   | SALARY | SALARY Category |
+--------+--------+-----------------+
| Raju   |  30000 | Mid Salary      |
| Paul   |  25000 | Lower Salary    |
| Alex   |  45000 | Mid Salary      |
| Victor |  30000 | Mid Salary      |
| Akshay |  50000 | Higher Salary   |
| Pravin |  70000 | Higher Salary   |
| Mayur  |  45000 | Mid Salary      |
| Vishu  |  30000 | Mid Salary      |
| Shan   |  70000 | Higher Salary   |
| Manish |  45000 | Mid Salary      |
+--------+--------+-----------------+
10 rows in set (0.00 sec)


*************************************************************************************************************************************************************************
*                               *
*  39. IS NULL                  *
*                               *
*********************************

# Use to check whether table contains null values.

SELECT name FROM employees WHERE name IS NULL;


*************************************************************************************************************************************************************************
*                               *
*  39. NOT LIKE                 *
*                               *
*********************************

# Opposite of LIKE Keyword.

mysql> SELECT * FROM employees WHERE name NOT LIKE "A%";
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma    |  30000 |
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  30000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  70000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |  45000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  30000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  70000 |
|    111 | Manish | Associate   | Operations | Patil     |  45000 |
+--------+--------+-------------+------------+-----------+--------+
8 rows in set (0.00 sec)


*************************************************************************************************************************************************************************
*                               *
*    Excercise 07               *
*                               *
*********************************


Q1. Find employees whose salary are between 30000 to 45000
mysql> SELECT * FROM employees WHERE SALARY BETWEEN 30000 AND 45000;
+--------+--------+-------------+------------+----------+--------+
| emp_id | name   | designation | dept       | lastname | SALARY |
+--------+--------+-------------+------------+----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma   |  30000 |
|    104 | Alex   | Accountant  | Account    | Rajput   |  45000 |
|    105 | Victor | Associate   | Deposit    | Corse    |  30000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede |  45000 |
|    109 | Vishu  | Lead        | Deposit    | Rick     |  30000 |
|    111 | Manish | Associate   | Operations | Patil    |  45000 |
+--------+--------+-------------+------------+----------+--------+
6 rows in set (0.00 sec)


Q2. Find employees whose first name start with 'V' or 'R'
mysql> SELECT * FROM employees WHERE name LIKE 'V%' OR name LIKE 'R%';
+--------+--------+-------------+---------+----------+--------+
| emp_id | name   | designation | dept    | lastname | SALARY |
+--------+--------+-------------+---------+----------+--------+
|    101 | Raju   | Manager     | Loan    | Sharma   |  30000 |
|    105 | Victor | Associate   | Deposit | Corse    |  30000 |
|    109 | Vishu  | Lead        | Deposit | Rick     |  30000 |
+--------+--------+-------------+---------+----------+--------+
3 rows in set (0.00 sec)



Q3. Find employees whose salary=30000 and department should be 'Deposit'
mysql> SELECT * FROM employees WHERE SALARY=30000 AND dept = 'Deposit';
+--------+--------+-------------+---------+----------+--------+
| emp_id | name   | designation | dept    | lastname | SALARY |
+--------+--------+-------------+---------+----------+--------+
|    105 | Victor | Associate   | Deposit | Corse    |  30000 |
|    109 | Vishu  | Lead        | Deposit | Rick     |  30000 |
+--------+--------+-------------+---------+----------+--------+
2 rows in set (0.00 sec)



Q4. Find employees from following designation
    Manager, Lead, Associate

mysql> SELECT * FROM employees WHERE designation IN('Manager', 'Lead', 'Associate');
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    101 | Raju   | Manager     | Loan       | Sharma    |  30000 |
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  30000 |
|    106 | Akshay | Manager     | IT         | kadam     |  50000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  70000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  30000 |
|    111 | Manish | Associate   | Operations | Patil     |  45000 |
+--------+--------+-------------+------------+-----------+--------+


Q5. Create new column as Salary in dollars and use case statement

mysql> SELECT
    -> SALARY,
    -> name,
    -> CASE
    ->  WHEN SALARY !=0 THEN SALARY/80
    -> END AS 'SALARY in Dollars'
    -> FROM employees;
+--------+--------+-------------------+
| SALARY | name   | SALARY in Dollars |
+--------+--------+-------------------+
|  30000 | Raju   |          375.0000 |
|  25000 | Paul   |          312.5000 |
|  45000 | Alex   |          562.5000 |
|  30000 | Victor |          375.0000 |
|  50000 | Akshay |          625.0000 |
|  70000 | Pravin |          875.0000 |
|  45000 | Mayur  |          562.5000 |
|  30000 | Vishu  |          375.0000 |
|  70000 | Shan   |          875.0000 |
|  45000 | Manish |          562.5000 |
+--------+--------+-------------------+
10 rows in set (0.00 sec)


*************************************************************************************************************************************************************************
*                               *
*  40. UNIQUE Constraint        *
*                               *
*********************************

# Need of UNIQUE Constraint:
  As we already have primary constraint in table for unique values but
  what if we need one more column whose values should be unique 
  for e.x phone number, so here comes UNIQUE constraint.

mysql> CREATE TABLE contact(
    -> mobile varchar(10) UNIQUE);
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO contact VALUES('7057472708');
Query OK, 1 row affected (0.02 sec)

mysql> SELECT * FROM contact;
+------------+
| mobile     |
+------------+
| 7057472708 |
+------------+
1 row in set (0.00 sec)




*************************************************************************************************************************************************************************
*                               *
*  40. CHECK Constraint         *
*                               *
*********************************

# To make sure mobilenumber is atleast 10 digits
# To apply above logic we need to add a condition while creating table.

mysql> CREATE TABLE contacts(
    -> mob varchar(12) UNIQUE CHECK (LENGTH(mob) >=10)
    -> );
Query OK, 0 rows affected (0.03 sec)

mysql> DESC contacts;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| mob   | varchar(12) | YES  | UNI | NULL    |       |
+-------+-------------+------+-----+---------+-------+
1 row in set (0.02 sec)

mysql> INSERT INTO contacts VALUES('123456');
ERROR 3819 (HY000): Check constraint 'contacts_chk_1' is violated.

mysql> SELECT * FROM contacts;
+------------+
| mob        |
+------------+
| 1234567890 |
| 1234567891 |
+------------+
2 rows in set (0.00 sec)



*************************************************************************************************************************************************************************
*                               *
*  41. NAMED Constraint         *
*                               *
*********************************

# As in above e.x we saw error as chk_1 violated,  we can customised
  that error.


mysql> CREATE TABLE new_contact(
    -> mob varchar(15) UNIQUE,
    -> CONSTRAINT mobno_less_than_10_digits CHECK(LENGTH(mob) >=10));
Query OK, 0 rows affected (0.03 sec)

mysql> INSERT INTO new_contact VALUES(123456);
ERROR 3819 (HY000): Check constraint 'mobno_less_than_10_digits' is violated.
mysql> INSERT INTO new_contact VALUES(1234567890);
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM new_contact;
+------------+
| mob        |
+------------+
| 1234567890 |
+------------+
1 row in set (0.01 sec)


*************************************************************************************************************************************************************************
*                               *
*  42. Alter Query              *
*                               *
*********************************

# TO add or remove column 
# To restructure our previous table

1. Adding new column:
ALTER TABLE table_name ADD COLUMN column_name datatype;

mysql> ALTER TABLE new_contact ADD COLUMN name varchar(50);
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> INSERT INTO new_contact VALUES(9856321478, 'Neeraj');
Query OK, 1 row affected (0.00 sec)

mysql> SELECT * FROM new_contact;
+------------+--------+
| mob        | name   |
+------------+--------+
| 1234567890 | NULL   |
| 9856321478 | Neeraj |
+------------+--------+
2 rows in set (0.00 sec)

# When we add new column in old table the older value of new column 
  is set to be NULL. 
# We can change it using update query.

2. Drop Column:
AALTER TABLE table_name DROP COLUMN column_name

mysql> ALTER TABLE new_contact DROP COLUMN name;
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM new_contact;
+------------+
| mob        |
+------------+
| 1234567890 |
| 9856321478 |
+------------+
2 rows in set (0.00 sec)


3. Renaming Column :

ALTER TABLE table_name RENAME COLUMN column_name TO new_name;


mysql> ALTER TABLE new_contact RENAME COLUMN name TO NAME;
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM new_contact;
+------------+--------+
| mob        | NAME   |
+------------+--------+
| 1234567890 | NULL   |
| 9856321478 | NULL   |
| 9856321477 | Neeraj |
+------------+--------+
3 rows in set (0.00 sec)


4. Renaming Table:

ALTER TABLE table_name RENAME TO new_name;
                OR
RENAME TABLE table_name TO new_name;

mysql> ALTER TABLE new_contact RENAME TO Contact5;
Query OK, 0 rows affected (0.03 sec)

mysql> SELECT * FROM Contact5;
+------------+--------+
| mob        | NAME   |
+------------+--------+
| 1234567890 | NULL   |
| 9856321478 | NULL   |
| 9856321477 | Neeraj |
+------------+--------+
3 rows in set (0.00 sec)

mysql> RENAME TABLE Contact5 TO Contact6;
Query OK, 0 rows affected (0.03 sec)
mysql> SELECT * FROM Contact6;
+------------+--------+
| mob        | NAME   |
+------------+--------+
| 1234567890 | NULL   |
| 9856321478 | NULL   |
| 9856321477 | Neeraj |
+------------+--------+
3 rows in set (0.01 sec)



5. Modify Column Property:
# Changing datatype or Adding Default values.

mysql> ALTER TABLE Contact6
    -> MODIFY mob VARCHAR(20) DEFAULT 'Unknown';
Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> DESC Contact6;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| mob   | varchar(20) | YES  | UNI | Unknown |       |
| NAME  | varchar(50) | YES  |     | NULL    |       |
+-------+-------------+------+-----+---------+-------+
2 rows in set (0.00 sec)






*************************************************************************************************************************************************************************
*                               *
*  43. Relationship In MYSQL    *
*                               *
*********************************

# Types of Relationship:
1. One to one: 
2. One to many








*************************************************************************************************************************************************************************
*                               *
*  42. Foreign Key              *
*                               *
*********************************

mysql> use stores;
Database changed
mysql> CREATE TABLE customers(
    -> cust_id INT AUTO_INCREMENT PRIMARY KEY,
    -> name VARCHAR(50),
    -> email VARCHAR(50)
    -> );
Query OK, 0 rows affected (0.04 sec)

mysql> DESC customers;
+---------+-------------+------+-----+---------+----------------+
| Field   | Type        | Null | Key | Default | Extra          |
+---------+-------------+------+-----+---------+----------------+
| cust_id | int         | NO   | PRI | NULL    | auto_increment |
| name    | varchar(50) | YES  |     | NULL    |                |
| email   | varchar(50) | YES  |     | NULL    |                |
+---------+-------------+------+-----+---------+----------------+
3 rows in set (0.04 sec)


mysql> CREATE TABLE orders(
    -> ord_id INT AUTO_INCREMENT PRIMARY KEY,
    -> date DATE,
    -> amount DECIMAL(10,2),
    -> cust_id INT,
    -> FOREIGN KEY(cust_id) REFERENCES customers(cust_id)
    -> );
Query OK, 0 rows affected (0.04 sec)

mysql> DESC orders;
+---------+---------------+------+-----+---------+----------------+
| Field   | Type          | Null | Key | Default | Extra          |
+---------+---------------+------+-----+---------+----------------+
| ord_id  | int           | NO   | PRI | NULL    | auto_increment |
| date    | date          | YES  |     | NULL    |                |
| amount  | decimal(10,2) | YES  |     | NULL    |                |
| cust_id | int           | YES  | MUL | NULL    |                |
+---------+---------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)


mysql> INSERT INTO customers(name,email) VALUES('Raju','raju@gmail.com'),('Sham','sham@gmail.com');
Query OK, 2 rows affected (0.05 sec)
Records: 2  Duplicates: 0  Warnings: 0



mysql> SELECT * FROM customers;
+---------+------+----------------+
| cust_id | name | email          |
+---------+------+----------------+
|       1 | Raju | raju@gmail.com |
|       2 | Sham | sham@gmail.com |
+---------+------+----------------+
2 rows in set (0.00 sec)


mysql> INSERT INTO orders(date,amount,cust_id) VALUES(CURDATE(),105.38,1);
Query OK, 1 row affected (0.05 sec)

mysql> INSERT INTO orders(date,amount,cust_id) VALUES(CURDATE(),500.38,1);
Query OK, 1 row affected (0.00 sec)

mysql> INSERT INTO orders(date,amount,cust_id) VALUES(CURDATE(),300.38,1);
Query OK, 1 row affected (0.04 sec)

mysql> INSERT INTO orders(date,amount,cust_id) VALUES(CURDATE(),300.38,2);
Query OK, 1 row affected (0.04 sec)

mysql> SELECT * FROM orders;
+--------+------------+--------+---------+
| ord_id | date       | amount | cust_id |
+--------+------------+--------+---------+
|      1 | 2024-09-20 | 105.38 |       1 |
|      2 | 2024-09-20 | 500.38 |       1 |
|      3 | 2024-09-20 | 300.38 |       1 |
|      4 | 2024-09-20 | 300.38 |       2 |
+--------+------------+--------+---------+
4 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                               *
*  44. Joins                    *
*                               *
*********************************

# Join operation is used to combine rows from two or more tables 
  based on a related column between them 


mysql> SELECT * FROM customers;
+---------+------+----------------+
| cust_id | name | email          |
+---------+------+----------------+
|       1 | Raju | raju@gmail.com |
|       2 | Sham | sham@gmail.com |
|       3 | Babu | babu@gmail.com |
|       4 | Paul | paul@gmail.com |
|       5 | Alex | alex@gmail.com |
+---------+------+----------------+
5 rows in set (0.00 sec)


  mysql> SELECT * FROM orders;
+--------+------------+---------+---------+
| ord_id | date       | amount  | cust_id |
+--------+------------+---------+---------+
|      1 | 2024-09-20 |  105.38 |       1 |
|      2 | 2024-09-20 |  500.38 |       1 |
|      3 | 2024-09-20 |  300.38 |       1 |
|      4 | 2024-09-20 |  300.38 |       2 |
|      5 | 2024-09-20 |  400.38 |       5 |
|      6 | 2024-09-20 |  700.00 |       4 |
|      7 | 2024-09-20 |  400.00 |       5 |
|      8 | 2024-09-20 | 1000.00 |       3 |
|      9 | 2024-09-20 | 1100.00 |       4 |
+--------+------------+---------+---------+
9 rows in set (0.00 sec)


Types of Join:
1. Cross Join:
# Every row from one table is combined with every row from 
  another table.


  mysql> SELECT * FROM customers, orders ;
+---------+------+----------------+--------+------------+---------+---------+
| cust_id | name | email          | ord_id | date       | amount  | cust_id |
+---------+------+----------------+--------+------------+---------+---------+
|       5 | Alex | alex@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       4 | Paul | paul@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       3 | Babu | babu@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       2 | Sham | sham@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       1 | Raju | raju@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       5 | Alex | alex@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       4 | Paul | paul@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       3 | Babu | babu@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       2 | Sham | sham@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       1 | Raju | raju@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       5 | Alex | alex@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       4 | Paul | paul@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       3 | Babu | babu@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       2 | Sham | sham@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       1 | Raju | raju@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       5 | Alex | alex@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       4 | Paul | paul@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       3 | Babu | babu@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       2 | Sham | sham@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       1 | Raju | raju@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       5 | Alex | alex@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       4 | Paul | paul@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       3 | Babu | babu@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       2 | Sham | sham@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       1 | Raju | raju@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       5 | Alex | alex@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       4 | Paul | paul@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       3 | Babu | babu@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       2 | Sham | sham@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       1 | Raju | raju@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       5 | Alex | alex@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
|       4 | Paul | paul@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
|       3 | Babu | babu@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
|       2 | Sham | sham@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
|       1 | Raju | raju@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
|       5 | Alex | alex@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       4 | Paul | paul@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       3 | Babu | babu@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       2 | Sham | sham@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       1 | Raju | raju@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       5 | Alex | alex@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
|       4 | Paul | paul@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
|       3 | Babu | babu@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
|       2 | Sham | sham@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
|       1 | Raju | raju@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
+---------+------+----------------+--------+------------+---------+---------+
45 rows in set (0.03 sec)

2. Inner Join:
# Return only the rows where there is a match between the 
  specified columns in both the left(first) and right(second) tables.

   mysql> SELECT * FROM customers
    -> INNER JOIN orders
    -> ON orders.cust_id =customers.cust_id;
+---------+------+----------------+--------+------------+---------+---------+
| cust_id | name | email          | ord_id | date       | amount  | cust_id |
+---------+------+----------------+--------+------------+---------+---------+
|       1 | Raju | raju@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       1 | Raju | raju@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       1 | Raju | raju@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       2 | Sham | sham@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       3 | Babu | babu@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       4 | Paul | paul@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       4 | Paul | paul@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
|       5 | Alex | alex@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       5 | Alex | alex@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
+---------+------+----------------+--------+------------+---------+---------+
9 rows in set (0.00 sec)


Inner Join with group by:

mysql> SELECT name FROM customers
    -> INNER JOIN orders
    -> ON orders.cust_id =customers.cust_id
    -> GROUP BY name;
+------+
| name |
+------+
| Raju |
| Sham |
| Babu |
| Paul |
| Alex |
+------+
5 rows in set (0.00 sec)

Sum of amount spend by each:
mysql> SELECT name, SUM(amount) FROM customers
    -> INNER JOIN orders
    -> ON orders.cust_id =customers.cust_id
    -> GROUP BY name;
+------+-------------+
| name | SUM(amount) |
+------+-------------+
| Raju |      906.14 |
| Sham |      300.38 |
| Babu |     1000.00 |
| Paul |     1800.00 |
| Alex |      800.38 |
+------+-------------+
5 rows in set (0.00 sec)




3. Left Join:
# Returns all rows from left table and matching rows from right table.

mysql> SELECT * FROM customers LEFT JOIN orders
    -> ON orders.cust_id=customers.cust_id;
+---------+------+----------------+--------+------------+---------+---------+
| cust_id | name | email          | ord_id | date       | amount  | cust_id |
+---------+------+----------------+--------+------------+---------+---------+
|       1 | Raju | raju@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       1 | Raju | raju@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       1 | Raju | raju@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       2 | Sham | sham@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       3 | Babu | babu@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       4 | Paul | paul@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       4 | Paul | paul@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
|       5 | Alex | alex@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       5 | Alex | alex@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
+---------+------+----------------+--------+------------+---------+---------+
9 rows in set (0.00 sec)

Group by:

mysql> SELECT name, SUM(amount) FROM customers
    -> LEFT JOIN orders
    -> ON orders.cust_id =customers.cust_id GROUP BY name;
+------+-------------+
| name | SUM(amount) |
+------+-------------+
| Raju |      906.14 |
| Sham |      300.38 |
| Babu |     1000.00 |
| Paul |     1800.00 |
| Alex |      800.38 |
+------+-------------+
5 rows in set (0.00 sec)



4. Right Join:
# 
Returns all rows from right table and matching rows from left table.

mysql> SELECT * FROM customers RIGHT JOIN orders
    -> ON orders.cust_id=customers.cust_id;
+---------+------+----------------+--------+------------+---------+---------+
| cust_id | name | email          | ord_id | date       | amount  | cust_id |
+---------+------+----------------+--------+------------+---------+---------+
|       1 | Raju | raju@gmail.com |      1 | 2024-09-20 |  105.38 |       1 |
|       1 | Raju | raju@gmail.com |      2 | 2024-09-20 |  500.38 |       1 |
|       1 | Raju | raju@gmail.com |      3 | 2024-09-20 |  300.38 |       1 |
|       2 | Sham | sham@gmail.com |      4 | 2024-09-20 |  300.38 |       2 |
|       5 | Alex | alex@gmail.com |      5 | 2024-09-20 |  400.38 |       5 |
|       4 | Paul | paul@gmail.com |      6 | 2024-09-20 |  700.00 |       4 |
|       5 | Alex | alex@gmail.com |      7 | 2024-09-20 |  400.00 |       5 |
|       3 | Babu | babu@gmail.com |      8 | 2024-09-20 | 1000.00 |       3 |
|       4 | Paul | paul@gmail.com |      9 | 2024-09-20 | 1100.00 |       4 |
+---------+------+----------------+--------+------------+---------+---------+
9 rows in set (0.00 sec)






*************************************************************************************************************************************************************************
*                               *
*  44. ON DELETE CASCADE        *
*                               *
*********************************

# we cannot delete record from customer table because it is associated
  with another table so we use delete cascade wile creating table.
# we will need to drop our order table  and create a new one.

mysql> DROP table orders;
Query OK, 0 rows affected (0.03 sec)

  mysql> CREATE TABLE orderss(ord_id INT AUTO_INCREMENT PRIMARY KEY,
    -> date DATE,
    -> amount DECIMAL(10, 2),
    -> cust_id INT,
    -> FOREIGN KEY (cust_id) REFERENCES customers(cust_id) ON DELETE CASCADE);
Query OK, 0 rows affected (0.04 sec)

mysql> INSERT INTO orderss(date,amount,cust_id) VALUES(CURDATE(), 100.50, 1),
    -> (CURDATE(), 300.30,1);
Query OK, 2 rows affected (0.02 sec)
Records: 2  Duplicates: 0  Warnings: 0



mysql> SELECT * from customers;
+---------+------+----------------+
| cust_id | name | email          |
+---------+------+----------------+
|       1 | Raju | raju@gmail.com |
|       2 | Sham | sham@gmail.com |
|       3 | Babu | babu@gmail.com |
|       4 | Paul | paul@gmail.com |
|       5 | Alex | alex@gmail.com |
+---------+------+----------------+
5 rows in set (0.00 sec)


mysql> SELECT * from orderss;
+--------+------------+--------+---------+
| ord_id | date       | amount | cust_id |
+--------+------------+--------+---------+
|      1 | 2024-09-21 | 100.50 |       1 |
|      2 | 2024-09-21 | 300.30 |       1 |
|      3 | 2024-09-21 | 120.50 |       2 |
+--------+------------+--------+---------+
3 rows in set (0.00 sec)



mysql> DELETE FROM customers WHERE name='Raju';
Query OK, 1 row affected (0.01 sec)

mysql> SELECT * FROM orderss;
+--------+------------+--------+---------+
| ord_id | date       | amount | cust_id |
+--------+------------+--------+---------+
|      3 | 2024-09-21 | 120.50 |       2 |
+--------+------------+--------+---------+
1 row in set (0.00 sec)

mysql> SELECT * FROM customers;
+---------+------+----------------+
| cust_id | name | email          |
+---------+------+----------------+
|       2 | Sham | sham@gmail.com |
|       3 | Babu | babu@gmail.com |
|       4 | Paul | paul@gmail.com |
|       5 | Alex | alex@gmail.com |
+---------+------+----------------+
4 rows in set (0.00 sec)





*************************************************************************************************************************************************************************
*                               *
*      Exercise 08              *
*                               *
*********************************

Create 2 tables Author and Books:


mysql> CREATE TABLE AUthors(
    -> author_id INT AUTO_INCREMENT PRIMARY KEY,
    -> author_name VARCHAR(50)
    -> );
Query OK, 0 rows affected (0.02 sec)


mysql> DESC Authors;
+-------------+-------------+------+-----+---------+----------------+
| Field       | Type        | Null | Key | Default | Extra          |
+-------------+-------------+------+-----+---------+----------------+
| author_id   | int         | NO   | PRI | NULL    | auto_increment |
| author_name | varchar(50) | YES  |     | NULL    |                |
+-------------+-------------+------+-----+---------+----------------+
2 rows in set (0.00 sec)

mysql> INSERT INTO Authors(author_name) VALUES('Raju'),('Sham'),('Baburao'),('Paul');
Query OK, 4 rows affected (0.02 sec)
Records: 4  Duplicates: 0  Warnings: 0


mysql> SELECT * FROM Authors;
+-----------+-------------+
| author_id | author_name |
+-----------+-------------+
|         1 | Raju        |
|         2 | Sham        |
|         3 | Baburao     |
|         4 | Paul        |
+-----------+-------------+
4 rows in set (0.00 sec)



mysql> CREATE TABLE Books(
    -> book_id INT AUTO_INCREMENT PRIMARY KEY,
    -> title VARCHAR(50),
    ->title VARCHAR(50),
    -> au_id INT,
    -> FOREIGN KEY (au_id) REFERENCES Authors(author_id) ON DELETE CASCADE
    -> );
Query OK, 0 rows affected (0.03 sec)


mysql> DESC Books;
+---------+-------------+------+-----+---------+----------------+
| Field   | Type        | Null | Key | Default | Extra          |
+---------+-------------+------+-----+---------+----------------+
| book_id | int         | NO   | PRI | NULL    | auto_increment |
| title   | varchar(50) | YES  |     | NULL    |                |
| au_id   | int         | YES  | MUL | NULL    |                |
| ratings | int         | YES  |     | NULL    |                |
+---------+-------------+------+-----+---------+----------------+
4 rows in set (0.00 sec)


mysql> INSERT INTO Books(title,ratings, au_id) VALUES
    -> ('Story of Raju',5,1),
    -> ('Story of Baburao', 4, 3),
    -> ('Raju- The Great MAn',2, 1),
    -> ('Love stiry by Sham',1, 2);
Query OK, 4 rows affected (0.04 sec)
Records: 4  Duplicates: 0  Warnings: 0



mysql> SELECT * FROM Books;
+---------+---------------------+-------+---------+
| book_id | title               | au_id | ratings |
+---------+---------------------+-------+---------+
|       1 | Story of Raju       |     1 |       5 |
|       2 | Story of Baburao    |     3 |       4 |
|       3 | Raju- The Great MAn |     1 |       2 |
|       4 | Love stiry by Sham  |     2 |       1 |
+---------+---------------------+-------+---------+
4 rows in set (0.00 sec)


mysql> SELECT * FROM Authors;
+-----------+-------------+
| author_id | author_name |
+-----------+-------------+
|         1 | Raju        |
|         2 | Sham        |
|         3 | Baburao     |
|         4 | Paul        |
+-----------+-------------+
4 rows in set (0.00 sec)

Q1. Display below table using joins:
+-------------+---------------------+---------+
| author_name | title               | ratings |
+-------------+---------------------+---------+
| Raju        | Story of Raju       |       5 |
| Raju        | Raju- The Great MAn |       2 |
| Sham        | Love stiry by Sham  |       1 |
| Baburao     | Story of Baburao    |       4 |
+-------------+---------------------+---------+
4 rows in set (0.00 sec)


Soluution: Observe the o/p carefully, you will see that o/p are only
matching values. Means table 1 value matches in table 2.

mysql> SELECT author_name,title, ratings FROM Authors
    -> INNER JOIN Books
    -> ON Books.au_id = Authors.author_id;
+-------------+---------------------+---------+
| author_name | title               | ratings |
+-------------+---------------------+---------+
| Raju        | Story of Raju       |       5 |
| Raju        | Raju- The Great MAn |       2 |
| Sham        | Love stiry by Sham  |       1 |
| Baburao     | Story of Baburao    |       4 |
+-------------+---------------------+---------+
4 rows in set (0.00 sec)


Q2. Display below table as o/p:
+-------------+---------------------+---------+
| author_name | title               | ratings |
+-------------+---------------------+---------+
| Raju        | Story of Raju       |       5 |
| Raju        | Raju- The Great MAn |       2 |
| Sham        | Love stiry by Sham  |       1 |
| Baburao     | Story of Baburao    |       4 |
| Paul        | NULL                |    NULL |
+-------------+---------------------+---------+

Solution: It is similar o/p as previous query just one record is addition 
added i.e Paul. Means we can see all records from left table and matching 
record from right table.

mysql> SELECT author_name, title, ratings
    -> FROM Authors
    -> LEFT JOIN Books
    -> ON Books.au_id = Authors.author_id;
+-------------+---------------------+---------+
| author_name | title               | ratings |
+-------------+---------------------+---------+
| Raju        | Story of Raju       |       5 |
| Raju        | Raju- The Great MAn |       2 |
| Sham        | Love stiry by Sham  |       1 |
| Baburao     | Story of Baburao    |       4 |
| Paul        | NULL                |    NULL |
+-------------+---------------------+---------+
5 rows in set (0.00 sec)


Q3. In Previous table Paul has value as NULL change title as NOT FOUND
    and rating as 0.

Solution:
We will use IFNULL() here 

mysql> SELECT author_name, IFNULL(title, 'NOT FOUND'), IFNULL(ratings,0)
    -> FROM Authors
    -> LEFT JOIN Books
    -> ON Books.au_id = Authors.author_id;
+-------------+----------------------------+-------------------+
| author_name | IFNULL(title, 'NOT FOUND') | IFNULL(ratings,0) |
+-------------+----------------------------+-------------------+
| Raju        | Story of Raju              |                 5 |
| Raju        | Raju- The Great MAn        |                 2 |
| Sham        | Love stiry by Sham         |                 1 |
| Baburao     | Story of Baburao           |                 4 |
| Paul        | NOT FOUND                  |                 0 |
+-------------+----------------------------+-------------------+
5 rows in set (0.00 sec)

Q4. Add new column as Remark and display below results:

+-------------+---------+---------+
| author_name | ratings | Remark  |
+-------------+---------+---------+
| Raju        |       5 | Good    |
| Raju        |       2 | Average |
| Sham        |       1 | Average |
| Baburao     |       4 | Good    |
+-------------+---------+---------+

Solution:

mysql> SELECT author_name, ratings,
    -> CASE
    -> WHEN ratings >=3 THEN 'Good'
    -> ELSE 'Average'
    -> END AS 'Remark'
    -> FROM Authors
    -> INNER JOIN Books
    -> ON Books.au_id = Authors.author_id;
+-------------+---------+---------+
| author_name | ratings | Remark  |
+-------------+---------+---------+
| Raju        |       5 | Good    |
| Raju        |       2 | Average |
| Sham        |       1 | Average |
| Baburao     |       4 | Good    |
+-------------+---------+---------+
4 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                                 *
*  45. Many To Many Relationship  *
*                                 *
***********************************

Use Case:
# Suppose in a database you have to create 2 tables Studnets and Courses.
# Both details are connected to each other.
  Like which student applied for which Courses?
  Like which courses has which which students?
# How M:M relation came??
  One student can apply for multiple courses, same one course can have
  multiple students.
# Create 2 tables student(s_id,s_name) courses(c_id,c_name,fees)
# In M:M relation there is concept called as bridge table or junction table,
  In bridge table we create separate table, it work is to connect the two tables.
  In our case student_course is a table contains student_id, course_id
# The student_id and course_id act as a foreign key and get connect to 
  s_id and c_id 

Practical:

mysql> CREATE DATABASE institute;
Query OK, 1 row affected (0.05 sec)

mysql> USE institute;
Database changed

mysql> CREATE TABLE students(
    -> s_id INT AUTO_INCREMENT PRIMARY KEY,
    -> s_name VARCHAR(250)
    -> );
Query OK, 0 rows affected (0.07 sec)

mysql> DESC students;
+--------+--------------+------+-----+---------+----------------+
| Field  | Type         | Null | Key | Default | Extra          |
+--------+--------------+------+-----+---------+----------------+
| s_id   | int          | NO   | PRI | NULL    | auto_increment |
| s_name | varchar(250) | YES  |     | NULL    |                |
+--------+--------------+------+-----+---------+----------------+
2 rows in set (0.05 sec)


mysql> CREATE TABLE courses(
    -> c_id INT AUTO_INCREMENT PRIMARY KEY,
    -> c_name VARCHAR(250),
    -> fees INT
    -> );
Query OK, 0 rows affected (0.07 sec)


mysql> DESC courses;

+--------+--------------+------+-----+---------+----------------+
| Field  | Type         | Null | Key | Default | Extra          |
+--------+--------------+------+-----+---------+----------------+
| c_id   | int          | NO   | PRI | NULL    | auto_increment |
| c_name | varchar(250) | YES  |     | NULL    |                |
| fees   | int          | YES  |     | NULL    |                |
+--------+--------------+------+-----+---------+----------------+
3 rows in set (0.01 sec)


Bridge Table:

mysql> CREATE TABLE student_course(
    -> student_id INT,
    -> course_id INT,
    -> FOREIGN KEY(student_id) REFERENCES students(s_id),
    -> FOREIGN KEY(course_id)  REFERENCES courses(c_id)
    -> );
Query OK, 0 rows affected (0.08 sec)

mysql> DESC student_course;
+------------+------+------+-----+---------+-------+
| Field      | Type | Null | Key | Default | Extra |
+------------+------+------+-----+---------+-------+
| student_id | int  | YES  | MUL | NULL    |       |
| course_id  | int  | YES  | MUL | NULL    |       |
+------------+------+------+-----+---------+-------+
2 rows in set (0.00 sec)


mysql> INSERT INTO students(s_name) VALUES('Raju'),('Sham'), ('Paul'), ('Alex');
Query OK, 4 rows affected (0.05 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM students;
+------+--------+
| s_id | s_name |
+------+--------+
|    1 | Raju   |
|    2 | Sham   |
|    3 | Paul   |
|    4 | Alex   |
+------+--------+
4 rows in set (0.00 sec)



mysql> INSERT INTO courses(c_id,c_name,fees) VALUES(101,'PD',3000);
Query OK, 1 row affected (0.05 sec)

mysql> INSERT INTO courses(c_name,fees) VALUES('Java',5000), ('SQL',4000),('Python',6000),('Linux',2500);
Query OK, 4 rows affected (0.04 sec)
Records: 4  Duplicates: 0  Warnings: 0


mysql> SELECT * FROM courses;
+------+--------+------+
| c_id | c_name | fees |
+------+--------+------+
|  101 | PD     | 3000 |
|  102 | Java   | 5000 |
|  103 | SQL    | 4000 |
|  104 | Python | 6000 |
|  105 | Linux  | 2500 |
+------+--------+------+
5 rows in set (0.00 sec)


mysql> INSERT INTO student_course(student_id, course_id) VALUES(1,101), (1,102),(2,105),(1,105),(3,103),(2,102),(4,104);
Query OK, 7 rows affected (0.01 sec)
Records: 7  Duplicates: 0  Warnings: 0

mysql> SELECT * FROM student_course;
+------------+-----------+
| student_id | course_id |
+------------+-----------+
|          1 |       101 |
|          1 |       102 |
|          2 |       105 |
|          1 |       105 |
|          3 |       103 |
|          2 |       102 |
|          4 |       104 |
+------------+-----------+
7 rows in set (0.00 sec)

Q1. Display student name and course name in which tey have enrolled
+--------+--------+
| s_name | c_name |
+--------+--------+
| Raju   | PD     |
| Raju   | Java   |
| Raju   | Linux  |
| Sham   | Linux  |
| Sham   | Java   |
| Paul   | SQL    |
| Alex   | Python |
+--------+--------+


Solution:
mysql> SELECT s_name, c_name FROM students
    -> JOIN
    -> student_course ON student_course.student_id =  students.s_id
    -> JOIN
    -> courses ON student_course.course_id = courses.c_id;
+--------+--------+
| s_name | c_name |
+--------+--------+
| Raju   | PD     |
| Raju   | Java   |
| Raju   | Linux  |
| Sham   | Linux  |
| Sham   | Java   |
| Paul   | SQL    |
| Alex   | Python |
+--------+--------+
7 rows in set (0.00 sec)



Q2. Print No. of students for each course.

mysql> SELECT c_name, COUNT(s_name) FROM students
    -> JOIN
    -> student_course ON student_course.student_id =  students.s_id
    -> JOIN
    -> courses ON student_course.course_id = courses.c_id
    -> GROUP BY c_name;
+--------+---------------+
| c_name | COUNT(s_name) |
+--------+---------------+
| PD     |             1 |
| Java   |             2 |
| Linux  |             2 |
| SQL    |             1 |
| Python |             1 |
+--------+---------------+
5 rows in set (0.00 sec)


Q3. Print no. of courses taken by each students.
+--------+---------------+
| s_name | COUNT(c_name) |
+--------+---------------+
| Raju   |             3 |
| Sham   |             2 |
| Paul   |             1 |
| Alex   |             1 |
+--------+---------------+
Solution:

mysql> SELECT s_name, COUNT(c_name) FROM students
    -> JOIN
    -> student_course ON student_course.student_id = students.s_id
    -> JOIN
    -> courses ON student_course.course_id = courses.c_id
    -> GROUP BY s_name;
+--------+---------------+
| s_name | COUNT(c_name) |
+--------+---------------+
| Raju   |             3 |
| Sham   |             2 |
| Paul   |             1 |
| Alex   |             1 |
+--------+---------------+
4 rows in set (0.00 sec)


Q4. Display Total fees paid by each student:
+--------+-----------+
| s_name | SUM(fees) |
+--------+-----------+
| Raju   |     10500 |
| Sham   |      7500 |
| Paul   |      4000 |
| Alex   |      6000 |
+--------+-----------+


Solution:

mysql> SELECT s_name, SUM(fees) FROM students
    -> JOIN
    -> student_course ON student_course.student_id = students.s_id
    -> JOIN
    -> courses ON student_course.course_id = courses.c_id
    -> GROUP BY s_name;
+--------+-----------+
| s_name | SUM(fees) |
+--------+-----------+
| Raju   |     10500 |
| Sham   |      7500 |
| Paul   |      4000 |
| Alex   |      6000 |
+--------+-----------+
4 rows in set (0.00 sec)



*************************************************************************************************************************************************************************
*                                    *
*  46. VIEW to create Virtual Tables *
*                                    *
**************************************

# Views are stored queries that when invoked produce a result set.
# A view acts as a virtual table.
# Creating view means keeping your columns of all tables in one container 
which can be helpful for retreiving data easily.
# Lets create a view and keep our previous tables columns in it.

mysql> CREATE VIEW inst_info AS
    -> SELECT s_name, c_name, fees FROM students
    -> JOIN
    -> student_course ON student_course.student_id = students.s_id
    -> JOIN
    -> courses ON student_course.course_id = courses.c_id;
Query OK, 0 rows affected (0.05 sec)

mysql> SHOW TABLES;
+---------------------+
| Tables_in_institute |
+---------------------+
| courses             |
| inst_info           |
| student_course      |
| students            |
+---------------------+
4 rows in set (0.04 sec)

# inst_info is a virtual table:
mysql> SELECT * FROM inst_info;
+--------+--------+------+
| s_name | c_name | fees |
+--------+--------+------+
| Raju   | PD     | 3000 |
| Raju   | Java   | 5000 |
| Raju   | Linux  | 2500 |
| Sham   | Linux  | 2500 |
| Sham   | Java   | 5000 |
| Paul   | SQL    | 4000 |
| Alex   | Python | 6000 |
+--------+--------+------+
7 rows in set (0.04 sec)

# Now we can perform our previous joins queries in easy way shown below.

Q1. Display student name and course name in which tey have enrolled
+--------+--------+
| s_name | c_name |
+--------+--------+
| Raju   | PD     |
| Raju   | Java   |
| Raju   | Linux  |
| Sham   | Linux  |
| Sham   | Java   |
| Paul   | SQL    |
| Alex   | Python |
+--------+--------+

solution:

mysql> SELECT s_name, c_name FROM inst_info;
+--------+--------+
| s_name | c_name |
+--------+--------+
| Raju   | PD     |
| Raju   | Java   |
| Raju   | Linux  |
| Sham   | Linux  |
| Sham   | Java   |
| Paul   | SQL    |
| Alex   | Python |
+--------+--------+
7 rows in set (0.00 sec)


Q2. Print No. of students for each course.
+--------+---------------+
| c_name | COUNT(s_name) |
+--------+---------------+
| PD     |             1 |
| Java   |             2 |
| Linux  |             2 |
| SQL    |             1 |
| Python |             1 |
+--------+---------------+

Solution:

mysql> SELECT  c_name, COUNT(s_name) FROM inst_info GROUP BY c_name;
+--------+---------------+
| c_name | COUNT(s_name) |
+--------+---------------+
| PD     |             1 |
| Java   |             2 |
| Linux  |             2 |
| SQL    |             1 |
| Python |             1 |
+--------+---------------+
5 rows in set (0.00 sec)



Q3. Print no. of courses taken by each students.
+--------+---------------+
| s_name | COUNT(c_name) |
+--------+---------------+
| Raju   |             3 |
| Sham   |             2 |
| Paul   |             1 |
| Alex   |             1 |
+--------+---------------+

Solution:

mysql> SELECT s_name, COUNT(c_name) FROM inst_info GROUP BY s_name;
+--------+---------------+
| s_name | COUNT(c_name) |
+--------+---------------+
| Raju   |             3 |
| Sham   |             2 |
| Paul   |             1 |
| Alex   |             1 |
+--------+---------------+
4 rows in set (0.00 sec)



Q4. Display Total fees paid by each student:
+--------+-----------+
| s_name | SUM(fees) |
+--------+-----------+
| Raju   |     10500 |
| Sham   |      7500 |
| Paul   |      4000 |
| Alex   |      6000 |
+--------+-----------+

mysql> SELECT s_name, SUM(fees) FROM inst_info GROUP BY s_name;
+--------+-----------+
| s_name | SUM(fees) |
+--------+-----------+
| Raju   |     10500 |
| Sham   |      7500 |
| Paul   |      4000 |
| Alex   |      6000 |
+--------+-----------+
4 rows in set (0.00 sec)


DELETE VIEW:
DROP VIEW  inst_info;



*************************************************************************************************************************************************************************
*                                    *
*  47. HAVING Clause                 *
*                                    *
**************************************

# Use with group by clause.

Q. Display student name who have paid more than 5000 fees overall.
# If we try to use where clause it will throw an error

mysql> SELECT s_name,SUM(fees) FROM inst_info GROUP BY s_name WHERE SUM(fees) >5000;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual
that corresponds to your MySQL server version for the right syntax to 
use near 'WHERE SUM(fees) >5000' at line 1

# Using HAVING Clause:

mysql> SELECT s_name,SUM(fees) FROM inst_info GROUP BY s_name HAVING SUM(fees) > 5000;
+--------+-----------+
| s_name | SUM(fees) |
+--------+-----------+
| Raju   |     10500 |
| Sham   |      7500 |
| Alex   |      6000 |
+--------+-----------+
3 rows in set (0.00 sec)





*************************************************************************************************************************************************************************
*                                    *
*  47. ROLLUP Clause                 *
*                                    *
**************************************

# Adds additional row at the end.
# Use with group by.

mysql> SELECT s_name,SUM(fees) FROM inst_info GROUP BY s_name WITH ROLLUP;
+--------+-----------+
| s_name | SUM(fees) |
+--------+-----------+
| Alex   |      6000 |
| Paul   |      4000 |
| Raju   |     10500 |
| Sham   |      7500 |
| NULL   |     28000 |
+--------+-----------+
5 rows in set (0.04 sec)

# Change NULL into Total:

mysql> SELECT IFNULL(s_name, 'Total'),SUM(fees) FROM inst_info GROUP BY s_name WITH ROLLUP;
+-------------------------+-----------+
| IFNULL(s_name, 'Total') | SUM(fees) |
+-------------------------+-----------+
| Alex                    |      6000 |
| Paul                    |      4000 |
| Raju                    |     10500 |
| Sham                    |      7500 |
| Total                   |     28000 |
+-------------------------+-----------+
5 rows in set (0.00 sec)


Number of fees paid by each student and total.
mysql> SELECT IFNULL(s_name, 'Total'), COUNT(fees) FROM inst_info GROUP BY s_name WITH ROLLUP;
+-------------------------+-------------+
| IFNULL(s_name, 'Total') | COUNT(fees) |
+-------------------------+-------------+
| Alex                    |           1 |
| Paul                    |           1 |
| Raju                    |           3 |
| Sham                    |           2 |
| Total                   |           7 |
+-------------------------+-------------+
5 rows in set (0.00 sec)




*************************************************************************************************************************************************************************
*                                    *
*  48. Stored Routine                *
*                                    *
**************************************

# An SQL statement or a set of SQL statement that can be stored on
  database server which can be calll no. of times.
# Two types of Stored Routines:
  1. STORED Procedure
  2. User Defined Functions

  1. STORED PROCEDURE:
     These are routines that contain a series of SQL statements and 
     procedural logic.
     Often used for performaing actions like data modification, transaction
     control, and executing sequence of statements.
      
DELIMITER: 
# After writing query we use semicolon as end sign, it is called as  
  delimiter.
# We can change this delimiter from ; to any other as shown below


mysql> DELIMITER $$
mysql> CREATE PROCEDURE emp_info()
    -> BEGIN
    ->   SELECT * FROM employees ORDER BY SALARY;
    -> END$$
Query OK, 0 rows affected (0.01 sec)

mysql> DELIMITER ;

mysql> call emp_info();
+--------+--------+-------------+------------+-----------+--------+
| emp_id | name   | designation | dept       | lastname  | SALARY |
+--------+--------+-------------+------------+-----------+--------+
|    103 | Paul   | Associate   | IT         | Verma     |  25000 |
|    101 | Raju   | Manager     | Loan       | Sharma    |  30000 |
|    105 | Victor | Associate   | Deposit    | Corse     |  30000 |
|    109 | Vishu  | Lead        | Deposit    | Rick      |  30000 |
|    104 | Alex   | Accountant  | Account    | Rajput    |  45000 |
|    108 | Mayur  | Cashier     | Account    | Wankhede  |  45000 |
|    111 | Manish | Associate   | Operations | Patil     |  45000 |
|    106 | Akshay | Manager     | IT         | kadam     |  50000 |
|    107 | Pravin | Lead        | IT         | Gartadkar |  70000 |
|    110 | Shan   | Peon        | Staff      | Patil     |  70000 |
+--------+--------+-------------+------------+-----------+--------+
10 rows in set (0.02 sec)



*************************************************************************************************************************************************************************
*                                             *
*  49. Argument passing in Stored Procedure:  *
*                                             *
***********************************************


Display emp id of employee by passing their name as Argument

mysql> DELIMITER $$
mysql> CREATE PROCEDURE get_emp_code(IN Ename VARCHAR(50))
    -> BEGIN
    ->    SELECT emp_id FROM employees WHERE name = Ename;
    -> END$$
Query OK, 0 rows affected (0.01 sec)

mysql> call get_emp_code('Manish');
+--------+
| emp_id |
+--------+
|    111 |
+--------+
1 row in set (0.00 sec)


*************************************************************************************************************************************************************************
*                                                           *
*  50. Returning Output In Variable In Stored Procedure:    *
*                                                           *
*************************************************************


mysql> DELIMITER $$
mysql> CREATE PROCEDURE get_sum_by_dept(IN p_dept VARCHAR(50), OUT p_sum DECIMAL(10,2))
    -> BEGIN
    -> SELECT SUM(SALARY) INTO p_sum FROM employees WHERE dept = p_dept;
    -> END$$
Query OK, 0 rows affected (0.02 sec)


mysql> DELIMITER ;

mysql> SET @emp_sum=0;
Query OK, 0 rows affected (0.00 sec)

mysql> CALL get_sum_by_dept('IT', @emp_sum);
Query OK, 1 row affected (0.01 sec)

mysql> SELECT @emp_sum;
+-----------+
| @emp_sum  |
+-----------+
| 145000.00 |
+-----------+
1 row in set (0.00 sec)


2. User Defined Fuctions:




DELIMITER $$

CREATE FUNCTION emp_name_max_salary() 
RETURNS VARCHAR(50)
DETERMINISTIC
BEGIN
    DECLARE v_max INT;
    DECLARE v_emp_name VARCHAR(50);
    SELECT MAX(SALARY) INTO v_max 
    FROM employees;
    SELECT name INTO v_emp_name 
    FROM employees
    WHERE SALARY = v_max
    RETURN v_emp_name;
END$$

DELIMITER ;

mysql> SELECT bank_db.emp_name_max_salary();
+-------------------------------+
| bank_db.emp_name_max_salary() |
+-------------------------------+
| Pravin                        |
+-------------------------------+
1 row in set (0.00 sec)



*************************************************************************************************************************************************************************
*                        *                                   
*  50. Window functions  *
*                        *                                   
**************************

# Introduced in version 8.0.
# Works in 8.0 and above

# Window functions, also known as analytic functions allow you to perform 
 calculations across a set of rows related to the current row.

# Lets try window function 
Here it returns same sum of salary for all records.
mysql> SELECT SUM(SALARY) OVER() AS SUM_SAL FROM employees;
+---------+
| SUM_SAL |
+---------+
|  440000 |
|  440000 |
|  440000 |
|  440000 |
|  440000 |
|  440000 |
|  440000 |
|  440000 |
|  440000 |
|  440000 |
+---------+
10 rows in set (0.04 sec)



mysql> SELECT emp_id, dept, SALARY,
    -> SUM(SALARY) OVER(ORDER BY emp_id) as SUM_Salary
    -> FROM employees;
+--------+------------+--------+------------+
| emp_id | dept       | SALARY | SUM_Salary |
+--------+------------+--------+------------+
|    101 | Loan       |  30000 |      30000 |
|    103 | IT         |  25000 |      55000 |
|    104 | Account    |  45000 |     100000 |
|    105 | Deposit    |  30000 |     130000 |
|    106 | IT         |  50000 |     180000 |
|    107 | IT         |  70000 |     250000 |
|    108 | Account    |  45000 |     295000 |
|    109 | Deposit    |  30000 |     325000 |
|    110 | Staff      |  70000 |     395000 |
|    111 | Operations |  45000 |     440000 |
+--------+------------+--------+------------+
10 rows in set (0.01 sec)



Partition means grouping


mysql> SELECT emp_id, dept, SALARY,
    -> SUM(SALARY) OVER(PARTITION BY dept) as SUM_Salary
    -> FROM employees;
+--------+------------+--------+------------+
| emp_id | dept       | SALARY | SUM_Salary |
+--------+------------+--------+------------+
|    104 | Account    |  45000 |      90000 |
|    108 | Account    |  45000 |      90000 |
|    105 | Deposit    |  30000 |      60000 |
|    109 | Deposit    |  30000 |      60000 |
|    103 | IT         |  25000 |     145000 |
|    106 | IT         |  50000 |     145000 |
|    107 | IT         |  70000 |     145000 |
|    101 | Loan       |  30000 |      30000 |
|    111 | Operations |  45000 |      45000 |
|    110 | Staff      |  70000 |      70000 |
+--------+------------+--------+------------+
10 rows in set (0.00 sec)



mysql> SELECT emp_id, dept, SALARY,
    -> MAX(SALARY) OVER(ORDER BY emp_id) as MAX_Salary
    -> FROM employees;
+--------+------------+--------+------------+
| emp_id | dept       | SALARY | MAX_Salary |
+--------+------------+--------+------------+
|    101 | Loan       |  30000 |      30000 |
|    103 | IT         |  25000 |      30000 |
|    104 | Account    |  45000 |      45000 |
|    105 | Deposit    |  30000 |      45000 |
|    106 | IT         |  50000 |      50000 |
|    107 | IT         |  70000 |      70000 |
|    108 | Account    |  45000 |      70000 |
|    109 | Deposit    |  30000 |      70000 |
|    110 | Staff      |  70000 |      70000 |
|    111 | Operations |  45000 |      70000 |
+--------+------------+--------+------------+
10 rows in set (0.00 sec)

We can also use;
ROW_NUMBER()
RANK()
DENSE_RANK()
LAG()
LEAD()

ROW_NUMBER:

mysql> SELECT
    -> ROW_NUMBER() OVER() AS row_no,
    -> emp_id,
    -> dept,
    -> SALARY FROM employees;
+--------+--------+------------+--------+
| row_no | emp_id | dept       | SALARY |
+--------+--------+------------+--------+
|      1 |    101 | Loan       |  30000 |
|      2 |    103 | IT         |  25000 |
|      3 |    104 | Account    |  45000 |
|      4 |    105 | Deposit    |  30000 |
|      5 |    106 | IT         |  50000 |
|      6 |    107 | IT         |  70000 |
|      7 |    108 | Account    |  45000 |
|      8 |    109 | Deposit    |  30000 |
|      9 |    110 | Staff      |  70000 |
|     10 |    111 | Operations |  45000 |
+--------+--------+------------+--------+
10 rows in set (0.01 sec)



mysql> SELECT
    -> ROW_NUMBER() OVER(ORDER BY SALARY) AS row_no,
    -> emp_id, dept, SALARY FROM employees;
+--------+--------+------------+--------+
| row_no | emp_id | dept       | SALARY |
+--------+--------+------------+--------+
|      1 |    103 | IT         |  25000 |
|      2 |    101 | Loan       |  30000 |
|      3 |    105 | Deposit    |  30000 |
|      4 |    109 | Deposit    |  30000 |
|      5 |    104 | Account    |  45000 |
|      6 |    108 | Account    |  45000 |
|      7 |    111 | Operations |  45000 |
|      8 |    106 | IT         |  50000 |
|      9 |    107 | IT         |  70000 |
|     10 |    110 | Staff      |  70000 |
+--------+--------+------------+--------+
10 rows in set (0.00 sec)


mysql> SELECT
    -> ROW_NUMBER() OVER(PARTITION BY dept) AS row_no,
    -> emp_id, dept, SALARY FROM employees;
+--------+--------+------------+--------+
| row_no | emp_id | dept       | SALARY |
+--------+--------+------------+--------+
|      1 |    104 | Account    |  45000 |
|      2 |    108 | Account    |  45000 |
|      1 |    105 | Deposit    |  30000 |
|      2 |    109 | Deposit    |  30000 |
|      1 |    103 | IT         |  25000 |
|      2 |    106 | IT         |  50000 |
|      3 |    107 | IT         |  70000 |
|      1 |    101 | Loan       |  30000 |
|      1 |    111 | Operations |  45000 |
|      1 |    110 | Staff      |  70000 |
+--------+--------+------------+--------+
10 rows in set (0.00 sec)



2. RANK():

mysql> SELECT
    -> emp_id, dept, SALARY,
    -> RANK() OVER() AS Rank_sal
    -> FROM employees;
+--------+------------+--------+----------+
| emp_id | dept       | SALARY | Rank_sal |
+--------+------------+--------+----------+
|    101 | Loan       |  30000 |        1 |
|    103 | IT         |  25000 |        1 |
|    104 | Account    |  45000 |        1 |
|    105 | Deposit    |  30000 |        1 |
|    106 | IT         |  50000 |        1 |
|    107 | IT         |  70000 |        1 |
|    108 | Account    |  45000 |        1 |
|    109 | Deposit    |  30000 |        1 |
|    110 | Staff      |  70000 |        1 |
|    111 | Operations |  45000 |        1 |
+--------+------------+--------+----------+
10 rows in set (0.00 sec)



mysql> SELECT
    -> emp_id, dept, SALARY,
    -> RANK() OVER(ORDER BY SALARY) AS Rank_sal
    -> FROM employees;
+--------+------------+--------+----------+
| emp_id | dept       | SALARY | Rank_sal |
+--------+------------+--------+----------+
|    103 | IT         |  25000 |        1 |
|    101 | Loan       |  30000 |        2 |
|    105 | Deposit    |  30000 |        2 |
|    109 | Deposit    |  30000 |        2 |
|    104 | Account    |  45000 |        5 |
|    108 | Account    |  45000 |        5 |
|    111 | Operations |  45000 |        5 |
|    106 | IT         |  50000 |        8 |
|    107 | IT         |  70000 |        9 |
|    110 | Staff      |  70000 |        9 |
+--------+------------+--------+----------+
10 rows in set (0.00 sec)





3. DENSE_RANK(): Gives better result than rank. Please check the difff

mysql> SELECT
    -> emp_id, dept, SALARY,
    -> DENSE_RANK() OVER(ORDER BY SALARY) AS Rank_sal
    -> FROM employees;
+--------+------------+--------+----------+
| emp_id | dept       | SALARY | Rank_sal |
+--------+------------+--------+----------+
|    103 | IT         |  25000 |        1 |
|    101 | Loan       |  30000 |        2 |
|    105 | Deposit    |  30000 |        2 |
|    109 | Deposit    |  30000 |        2 |
|    104 | Account    |  45000 |        3 |
|    108 | Account    |  45000 |        3 |
|    111 | Operations |  45000 |        3 |
|    106 | IT         |  50000 |        4 |
|    107 | IT         |  70000 |        5 |
|    110 | Staff      |  70000 |        5 |
+--------+------------+--------+----------+
10 rows in set (0.00 sec)



4. LAG():
# Applicable on a column.
# lags one previous record.

mysql> SELECT
    -> emp_id, dept, SALARY,
    -> LAG(SALARY) OVER() AS Lag_sal
    -> FROM employees;
+--------+------------+--------+---------+
| emp_id | dept       | SALARY | Lag_sal |
+--------+------------+--------+---------+
|    101 | Loan       |  30000 |    NULL |
|    103 | IT         |  25000 |   30000 |
|    104 | Account    |  45000 |   25000 |
|    105 | Deposit    |  30000 |   45000 |
|    106 | IT         |  50000 |   30000 |
|    107 | IT         |  70000 |   50000 |
|    108 | Account    |  45000 |   70000 |
|    109 | Deposit    |  30000 |   45000 |
|    110 | Staff      |  70000 |   30000 |
|    111 | Operations |  45000 |   70000 |
+--------+------------+--------+---------+
10 rows in set (0.01 sec)

Where to use??

mysql> SELECT
    -> emp_id, dept, SALARY,
    -> SALARY - LAG(SALARY) OVER(ORDER BY SALARY DESC) AS diff_Lag_sal
    -> FROM employees;
+--------+------------+--------+--------------+
| emp_id | dept       | SALARY | diff_Lag_sal |
+--------+------------+--------+--------------+
|    107 | IT         |  70000 |         NULL |
|    110 | Staff      |  70000 |            0 |
|    106 | IT         |  50000 |       -20000 |
|    104 | Account    |  45000 |        -5000 |
|    108 | Account    |  45000 |            0 |
|    111 | Operations |  45000 |            0 |
|    101 | Loan       |  30000 |       -15000 |
|    105 | Deposit    |  30000 |            0 |
|    109 | Deposit    |  30000 |            0 |
|    103 | IT         |  25000 |        -5000 |
+--------+------------+--------+--------------+
10 rows in set (0.00 sec)



5. LEAD()

mysql> SELECT
    -> emp_id, dept, SALARY,
    -> LEAD(SALARY) OVER() AS Lag_sal
    -> FROM employees;
+--------+------------+--------+---------+
| emp_id | dept       | SALARY | Lag_sal |
+--------+------------+--------+---------+
|    101 | Loan       |  30000 |   25000 |
|    103 | IT         |  25000 |   45000 |
|    104 | Account    |  45000 |   30000 |
|    105 | Deposit    |  30000 |   50000 |
|    106 | IT         |  50000 |   70000 |
|    107 | IT         |  70000 |   45000 |
|    108 | Account    |  45000 |   30000 |
|    109 | Deposit    |  30000 |   70000 |
|    110 | Staff      |  70000 |   45000 |
|    111 | Operations |  45000 |    NULL |
+--------+------------+--------+---------+
10 rows in set (0.00 sec)



Where to use??


mysql> SELECT
    -> emp_id, dept, SALARY,
    -> SALARY - LEAD(SALARY) OVER(ORDER BY SALARY DESC) AS diff_Lead_sal
    -> FROM employees;
+--------+------------+--------+---------------+
| emp_id | dept       | SALARY | diff_Lead_sal |
+--------+------------+--------+---------------+
|    107 | IT         |  70000 |             0 |
|    110 | Staff      |  70000 |         20000 |
|    106 | IT         |  50000 |          5000 |
|    104 | Account    |  45000 |             0 |
|    108 | Account    |  45000 |             0 |
|    111 | Operations |  45000 |         15000 |
|    101 | Loan       |  30000 |             0 |
|    105 | Deposit    |  30000 |             0 |
|    109 | Deposit    |  30000 |          5000 |
|    103 | IT         |  25000 |          NULL |
+--------+------------+--------+---------------+
10 rows in set (0.00 sec)